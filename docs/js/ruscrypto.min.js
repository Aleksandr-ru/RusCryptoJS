!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("RusCryptoJS",[],t):"object"==typeof exports?exports.RusCryptoJS=t():e.RusCryptoJS=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=76)}([function(e,t,n){var r=n(39)("wks"),i=n(15),o=n(1).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var r=n(4);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(7)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(2),i=n(57),o=n(34),a=Object.defineProperty;t.f=n(3)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(5),i=n(23);e.exports=n(3)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(12),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(31);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(1),i=n(6),o=n(11),a=n(15)("src"),c=Function.toString,u=(""+c).split("toString");n(13).inspectSource=function(e){return c.call(e)},(e.exports=function(e,t,n,c){var _="function"==typeof n;_&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(_&&(o(n,a)||i(n,a,e[t]?""+e[t]:u.join(String(t)))),e===r?e[t]=n:c?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||c.call(this)})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t){var n=e.exports={version:"2.6.3"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=!1},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(1),i=n(13),o=n(6),a=n(10),c=n(17),u=function(e,t,n){var _,s,l,E,f=e&u.F,C=e&u.G,p=e&u.S,d=e&u.P,I=e&u.B,A=C?r:p?r[t]||(r[t]={}):(r[t]||{}).prototype,g=C?i:i[t]||(i[t]={}),h=g.prototype||(g.prototype={});for(_ in C&&(n=t),n)l=((s=!f&&A&&void 0!==A[_])?A:n)[_],E=I&&s?c(l,r):d&&"function"==typeof l?c(Function.call,l):l,A&&a(A,_,l,e&u.U),g[_]!=l&&o(g,_,E),d&&h[_]!=l&&(h[_]=l)};r.core=i,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,n){var r=n(35);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var r=n(42),i=n(31);e.exports=function(e){return r(i(e))}},function(e,t){e.exports={}},function(e,t,n){var r=n(59),i=n(44);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){"use strict";var r=n(87),i=n(88),o=n(20),a=n(19);e.exports=n(70)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var r=n(2),i=n(8),o=n(52),a=n(54);n(55)("match",1,function(e,t,n,c){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=c(n,e,this);if(t.done)return t.value;var u=r(e),_=String(this);if(!u.global)return a(u,_);var s=u.unicode;u.lastIndex=0;for(var l,E=[],f=0;null!==(l=a(u,_));){var C=String(l[0]);E[f]=C,""===C&&(u.lastIndex=o(_,i(u.lastIndex),s)),f++}return 0===f?null:E}]})},function(e,t,n){var r=n(59),i=n(44).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(5).f,i=n(11),o=n(0)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";n(91);var r=n(2),i=n(33),o=n(3),a=/./.toString,c=function(e){n(10)(RegExp.prototype,"toString",e,!0)};n(7)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?c(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)}):"toString"!=a.name&&c(function(){return a.call(this)})},function(e,t,n){"use strict";var r,i,o,a,c=n(14),u=n(1),_=n(17),s=n(32),l=n(16),E=n(4),f=n(35),C=n(48),p=n(92),d=n(69),I=n(72).set,A=n(95)(),g=n(73),h=n(96),O=n(97),T=n(98),S=u.TypeError,N=u.process,R=N&&N.versions,v=R&&R.v8||"",m=u.Promise,P="process"==s(N),y=function(){},D=i=g.f,L=!!function(){try{var e=m.resolve(1),t=(e.constructor={})[n(0)("species")]=function(e){e(y,y)};return(P||"function"==typeof PromiseRejectionEvent)&&e.then(y)instanceof t&&0!==v.indexOf("6.6")&&-1===O.indexOf("Chrome/66")}catch(e){}}(),b=function(e){var t;return!(!E(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;A(function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,c=i?t.ok:t.fail,u=t.resolve,_=t.reject,s=t.domain;try{c?(i||(2==e._h&&x(e),e._h=1),!0===c?n=r:(s&&s.enter(),n=c(r),s&&(s.exit(),a=!0)),n===t.promise?_(S("Promise-chain cycle")):(o=b(n))?o.call(n,u,_):u(n)):_(r)}catch(e){s&&!a&&s.exit(),_(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&w(e)})}},w=function(e){I.call(u,function(){var t,n,r,i=e._v,o=U(e);if(o&&(t=h(function(){P?N.emit("unhandledRejection",i,e):(n=u.onunhandledrejection)?n({promise:e,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=P||U(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},U=function(e){return 1!==e._h&&0===(e._a||e._c).length},x=function(e){I.call(u,function(){var t;P?N.emit("rejectionHandled",e):(t=u.onrejectionhandled)&&t({promise:e,reason:e._v})})},K=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw S("Promise can't be resolved itself");(t=b(e))?A(function(){var r={_w:n,_d:!1};try{t.call(e,_(F,r,1),_(K,r,1))}catch(e){K.call(r,e)}}):(n._v=e,n._s=1,M(n,!1))}catch(e){K.call({_w:n,_d:!1},e)}}};L||(m=function(e){C(this,m,"Promise","_h"),f(e),r.call(this);try{e(_(F,this,1),_(K,this,1))}catch(e){K.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(47)(m.prototype,{then:function(e,t){var n=D(d(this,m));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=P?N.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=_(F,e,1),this.reject=_(K,e,1)},g.f=D=function(e){return e===m||e===a?new o(e):i(e)}),l(l.G+l.W+l.F*!L,{Promise:m}),n(26)(m,"Promise"),n(45)("Promise"),a=n(13).Promise,l(l.S+l.F*!L,"Promise",{reject:function(e){var t=D(this);return(0,t.reject)(e),t.promise}}),l(l.S+l.F*(c||!L),"Promise",{resolve:function(e){return T(c&&this===a?m:this,e)}}),l(l.S+l.F*!(L&&n(71)(function(e){m.all(e).catch(y)})),"Promise",{all:function(e){var t=this,n=D(t),r=n.resolve,i=n.reject,o=h(function(){var n=[],o=0,a=1;p(e,!1,function(e){var c=o++,u=!1;n.push(void 0),a++,t.resolve(e).then(function(e){u||(u=!0,n[c]=e,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=D(t),r=n.reject,i=h(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(e,t,n){var r=function(e){function t(e){return!!(e&&e.call&&e.apply)}function n(e,n){return t(e[n])?function(){return e[n].apply(e,arguments)}:e[n]}function r(e){return function(){return e}}function i(){e.ready=Promise.resolve(!0),e.isExtensionInstalled=r(Promise.resolve(!1)),e.isPluginInstalled=r(Promise.resolve(!0)),e.loadPlugin=o,window.rutokenLoaded=c}function o(){var e=document.createElement("object");return e.style.setProperty("visibility","hidden","important"),e.style.setProperty("width","0px","important"),e.style.setProperty("height","0px","important"),e.style.setProperty("margin","0px","important"),e.style.setProperty("padding","0px","important"),e.style.setProperty("border-style","none","important"),e.style.setProperty("border-width","0px","important"),e.style.setProperty("max-width","0px","important"),e.style.setProperty("max-height","0px","important"),e.innerHTML="<param name='onload' value='rutokenLoaded'/>",e.setAttribute("type",E),document.body.appendChild(e),new Promise(function(e,t){l.push(e)})}function a(){return f.loadPlugin().then(function(e){return function e(r){var i={},o=[];for(var a in r)!function(a){t(r[a].then)?o.push(r[a].then(function(o){return e(o).then(function(e){t(e)?i[a]=n(r,a):i[a]=e})})):i[a]=r[a]}(a);return 0==o.length?new Promise(function(e){e(r)}):Promise.all(o).then(function(){return i})}(e)}).then(function(e){return e.wrapWithOldInterface=u,e})}function c(e,t){s(e).then(function(e){if(0==l.length)throw"Internal error";l.shift()(e)})}function u(){var e={};for(var n in this)t(this[n])?e[n]=function(e,t){return function(){var n=arguments[arguments.length-2],r=arguments[arguments.length-1],i=Array.prototype.slice.call(arguments,0,-2);return t.apply(e,i).then(function(e){n(e)},function(e){r(e.message)})}}(this,this[n]):e[n]=this[n];return new Promise(function(t){t(e)})}function _(){var e={originalObject:this.originalObject};for(var t in this.originalObject)e[t]=n(this.originalObject,t);return new Promise(function(t){t(e)})}function s(e){var n={originalObject:e,wrapWithOldInterface:_};for(var r in e)t(e[r])?n[r]=function(e,t){return function(){var n=Array.prototype.slice.call(arguments);return new Promise(function(r,i){n.push(r,i),t.apply(e,n)})}}(e,e[r]):n[r]=e[r];return new Promise(function(e){e(n)})}var l=[],E="application/x-rutoken-pki",f=window["C3B7563B-BF85-45B7-88FC-7CFF1BD3C2DB"];if(f)!function(){var t=f.initialize().then(function(){return f.isPluginInstalled()}).then(function(t){return e.isExtensionInstalled=r(Promise.resolve(!0)),e.isPluginInstalled=n(f,"isPluginInstalled"),t&&(E="application/x-rutoken-plugin",e.loadPlugin=a),!0});e.ready=t}();else if(navigator.mimeTypes&&navigator.mimeTypes[E])i();else try{new ActiveXObject("Aktiv.CryptoPlugin"),i()}catch(t){e.ready=Promise.resolve(!0),e.isExtensionInstalled=r(Promise.resolve(!1)),e.isPluginInstalled=r(Promise.resolve(!1))}return e}(r||{});e.exports=r},function(e,t,n){"use strict";var r=n(2),i=n(9),o=n(8),a=n(12),c=n(52),u=n(54),_=Math.max,s=Math.min,l=Math.floor,E=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g;n(55)("replace",2,function(e,t,n,C){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=C(n,e,this,t);if(i.done)return i.value;var l=r(e),E=String(this),f="function"==typeof t;f||(t=String(t));var d=l.global;if(d){var I=l.unicode;l.lastIndex=0}for(var A=[];;){var g=u(l,E);if(null===g)break;if(A.push(g),!d)break;""===String(g[0])&&(l.lastIndex=c(E,o(l.lastIndex),I))}for(var h,O="",T=0,S=0;S<A.length;S++){g=A[S];for(var N=String(g[0]),R=_(s(a(g.index),E.length),0),v=[],m=1;m<g.length;m++)v.push(void 0===(h=g[m])?h:String(h));var P=g.groups;if(f){var y=[N].concat(v,R,E);void 0!==P&&y.push(P);var D=String(t.apply(void 0,y))}else D=p(N,E,R,v,P,t);R>=T&&(O+=E.slice(T,R)+D,T=R+N.length)}return O+E.slice(T)}];function p(e,t,r,o,a,c){var u=r+e.length,_=o.length,s=f;return void 0!==a&&(a=i(a),s=E),n.call(c,s,function(n,i){var c;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(u);case"<":c=a[i.slice(1,-1)];break;default:var s=+i;if(0===s)return n;if(s>_){var E=l(s/10);return 0===E?n:E<=_?void 0===o[E-1]?i.charAt(1):o[E-1]+i.charAt(1):n}c=o[s-1]}return void 0===c?"":c})}})},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(18),i=n(0)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){"use strict";var r=n(2);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(12),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){for(var r=n(22),i=n(21),o=n(10),a=n(1),c=n(6),u=n(20),_=n(0),s=_("iterator"),l=_("toStringTag"),E=u.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},C=i(f),p=0;p<C.length;p++){var d,I=C[p],A=f[I],g=a[I],h=g&&g.prototype;if(h&&(h[s]||c(h,s,E),h[l]||c(h,l,I),u[I]=E,A))for(d in r)h[d]||o(h,d,r[d],!0)}},function(e,t,n){var r=n(13),i=n(1),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(14)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(4),i=n(1).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(36),i=n(23),o=n(19),a=n(34),c=n(11),u=n(57),_=Object.getOwnPropertyDescriptor;t.f=n(3)?_:function(e,t){if(e=o(e),t=a(t,!0),u)try{return _(e,t)}catch(e){}if(c(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(18);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){var r=n(39)("keys"),i=n(15);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(1),i=n(5),o=n(3),a=n(0)("species");e.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){n(81)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){var r=n(10);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(2),i=n(83),o=n(44),a=n(43)("IE_PROTO"),c=function(){},u=function(){var e,t=n(40)("iframe"),r=o.length;for(t.style.display="none",n(65).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[o[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(c.prototype=r(e),n=new c,c.prototype=null,n[a]=e):n=u(),void 0===t?n:i(n,t)}},function(e,t,n){"use strict";var r=n(53)(!0);n(70)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";var r=n(53)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r=n(12),i=n(31);e.exports=function(e){return function(t,n){var o,a,c=String(i(t)),u=r(n),_=c.length;return u<0||u>=_?e?"":void 0:(o=c.charCodeAt(u))<55296||o>56319||u+1===_||(a=c.charCodeAt(u+1))<56320||a>57343?e?c.charAt(u):o:e?c.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(32),i=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var o=n.call(e,t);if("object"!=typeof o)throw new TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},function(e,t,n){"use strict";n(77);var r=n(10),i=n(6),o=n(7),a=n(31),c=n(0),u=n(56),_=c("species"),s=!o(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),l=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var E=c(e),f=!o(function(){var t={};return t[E]=function(){return 7},7!=""[e](t)}),C=f?!o(function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[_]=function(){return n}),n[E](""),!t}):void 0;if(!f||!C||"replace"===e&&!s||"split"===e&&!l){var p=/./[E],d=n(a,E,""[e],function(e,t,n,r,i){return t.exec===u?f&&!i?{done:!0,value:p.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),I=d[0],A=d[1];r(String.prototype,e,I),i(RegExp.prototype,E,2==t?function(e,t){return A.call(e,this,t)}:function(e){return A.call(e,this)})}}},function(e,t,n){"use strict";var r,i,o=n(33),a=RegExp.prototype.exec,c=String.prototype.replace,u=a,_=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r.lastIndex||0!==i.lastIndex),s=void 0!==/()??/.exec("")[1];(_||s)&&(u=function(e){var t,n,r,i,u=this;return s&&(n=new RegExp("^"+u.source+"$(?!\\s)",o.call(u))),_&&(t=u.lastIndex),r=a.call(u,e),_&&r&&(u.lastIndex=u.global?r.index+r[0].length:t),s&&r&&r.length>1&&c.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r}),e.exports=u},function(e,t,n){e.exports=!n(3)&&!n(7)(function(){return 7!=Object.defineProperty(n(40)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(1),i=n(78),o=n(5).f,a=n(25).f,c=n(80),u=n(33),_=r.RegExp,s=_,l=_.prototype,E=/a/g,f=/a/g,C=new _(E)!==E;if(n(3)&&(!C||n(7)(function(){return f[n(0)("match")]=!1,_(E)!=E||_(f)==f||"/a/i"!=_(E,"i")}))){_=function(e,t){var n=this instanceof _,r=c(e),o=void 0===t;return!n&&r&&e.constructor===_&&o?e:i(C?new s(r&&!o?e.source:e,t):s((r=e instanceof _)?e.source:e,r&&o?u.call(e):t),n?this:l,_)};for(var p=function(e){e in _||o(_,e,{configurable:!0,get:function(){return s[e]},set:function(t){s[e]=t}})},d=a(s),I=0;d.length>I;)p(d[I++]);l.constructor=_,_.prototype=l,n(10)(r,"RegExp",_)}n(45)("RegExp")},function(e,t,n){var r=n(11),i=n(19),o=n(60)(!1),a=n(43)("IE_PROTO");e.exports=function(e,t){var n,c=i(e),u=0,_=[];for(n in c)n!=a&&r(c,n)&&_.push(n);for(;t.length>u;)r(c,n=t[u++])&&(~o(_,n)||_.push(n));return _}},function(e,t,n){var r=n(19),i=n(8),o=n(37);e.exports=function(e){return function(t,n,a){var c,u=r(t),_=i(u.length),s=o(a,_);if(e&&n!=n){for(;_>s;)if((c=u[s++])!=c)return!0}else for(;_>s;s++)if((e||s in u)&&u[s]===n)return e||s||0;return!e&&-1}}},function(e,t,n){for(var r,i=n(1),o=n(6),a=n(15),c=a("typed_array"),u=a("view"),_=!(!i.ArrayBuffer||!i.DataView),s=_,l=0,E="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(r=i[E[l++]])?(o(r.prototype,c,!0),o(r.prototype,u,!0)):s=!1;e.exports={ABV:_,CONSTR:s,TYPED:c,VIEW:u}},function(e,t,n){var r=n(12),i=n(8);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){"use strict";var r=n(9),i=n(37),o=n(8);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,c=i(a>1?arguments[1]:void 0,n),u=a>2?arguments[2]:void 0,_=void 0===u?n:i(u,n);_>c;)t[c++]=e;return t}},function(e,t,n){var r=n(20),i=n(0)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){var r=n(1).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(11),i=n(9),o=n(43)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(32),i=n(0)("iterator"),o=n(20);e.exports=n(13).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){var r=n(18);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(2),i=n(35),o=n(0)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},function(e,t,n){"use strict";var r=n(14),i=n(16),o=n(10),a=n(6),c=n(20),u=n(89),_=n(26),s=n(66),l=n(0)("iterator"),E=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,n,C,p,d,I){u(n,t,C);var A,g,h,O=function(e){if(!E&&e in R)return R[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",S="values"==p,N=!1,R=e.prototype,v=R[l]||R["@@iterator"]||p&&R[p],m=v||O(p),P=p?S?O("entries"):m:void 0,y="Array"==t&&R.entries||v;if(y&&(h=s(y.call(new e)))!==Object.prototype&&h.next&&(_(h,T,!0),r||"function"==typeof h[l]||a(h,l,f)),S&&v&&"values"!==v.name&&(N=!0,m=function(){return v.call(this)}),r&&!I||!E&&!N&&R[l]||a(R,l,m),c[t]=m,c[T]=f,p)if(A={values:S?m:O("values"),keys:d?m:O("keys"),entries:P},I)for(g in A)g in R||o(R,g,A[g]);else i(i.P+i.F*(E||N),t,A);return A}},function(e,t,n){var r=n(0)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){var r,i,o,a=n(17),c=n(94),u=n(65),_=n(40),s=n(1),l=s.process,E=s.setImmediate,f=s.clearImmediate,C=s.MessageChannel,p=s.Dispatch,d=0,I={},A=function(){var e=+this;if(I.hasOwnProperty(e)){var t=I[e];delete I[e],t()}},g=function(e){A.call(e.data)};E&&f||(E=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return I[++d]=function(){c("function"==typeof e?e:Function(e),t)},r(d),d},f=function(e){delete I[e]},"process"==n(18)(l)?r=function(e){l.nextTick(a(A,e,1))}:p&&p.now?r=function(e){p.now(a(A,e,1))}:C?(o=(i=new C).port2,i.port1.onmessage=g,r=a(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(r=function(e){s.postMessage(e+"","*")},s.addEventListener("message",g,!1)):r="onreadystatechange"in _("script")?function(e){u.appendChild(_("script")).onreadystatechange=function(){u.removeChild(this),A.call(e)}}:function(e){setTimeout(a(A,e,1),0)}),e.exports={set:E,clear:f}},function(e,t,n){"use strict";var r=n(35);function i(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(1),i=n(13),o=n(14),a=n(75),c=n(5).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||c(t,e,{value:a.f(e)})}},function(e,t,n){t.f=n(0)},function(e,t,n){e.exports=n(110)},function(e,t,n){"use strict";var r=n(56);n(16)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){var r=n(4),i=n(79).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){var r=n(4),i=n(2),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(17)(Function.call,n(41).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){var r=n(4),i=n(18),o=n(0)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){"use strict";if(n(3)){var r=n(14),i=n(1),o=n(7),a=n(16),c=n(61),u=n(82),_=n(17),s=n(48),l=n(23),E=n(6),f=n(47),C=n(12),p=n(8),d=n(62),I=n(37),A=n(34),g=n(11),h=n(32),O=n(4),T=n(9),S=n(64),N=n(49),R=n(66),v=n(25).f,m=n(67),P=n(15),y=n(0),D=n(84),L=n(60),b=n(69),M=n(22),w=n(20),U=n(71),x=n(45),K=n(63),F=n(90),j=n(5),G=n(41),X=j.f,B=G.f,Y=i.RangeError,H=i.TypeError,V=i.Uint8Array,k=Array.prototype,W=u.ArrayBuffer,J=u.DataView,q=D(0),z=D(2),Z=D(3),$=D(4),Q=D(5),ee=D(6),te=L(!0),ne=L(!1),re=M.values,ie=M.keys,oe=M.entries,ae=k.lastIndexOf,ce=k.reduce,ue=k.reduceRight,_e=k.join,se=k.sort,le=k.slice,Ee=k.toString,fe=k.toLocaleString,Ce=y("iterator"),pe=y("toStringTag"),de=P("typed_constructor"),Ie=P("def_constructor"),Ae=c.CONSTR,ge=c.TYPED,he=c.VIEW,Oe=D(1,function(e,t){return ve(b(e,e[Ie]),t)}),Te=o(function(){return 1===new V(new Uint16Array([1]).buffer)[0]}),Se=!!V&&!!V.prototype.set&&o(function(){new V(1).set({})}),Ne=function(e,t){var n=C(e);if(n<0||n%t)throw Y("Wrong offset!");return n},Re=function(e){if(O(e)&&ge in e)return e;throw H(e+" is not a typed array!")},ve=function(e,t){if(!(O(e)&&de in e))throw H("It is not a typed array constructor!");return new e(t)},me=function(e,t){return Pe(b(e,e[Ie]),t)},Pe=function(e,t){for(var n=0,r=t.length,i=ve(e,r);r>n;)i[n]=t[n++];return i},ye=function(e,t,n){X(e,t,{get:function(){return this._d[n]}})},De=function(e){var t,n,r,i,o,a,c=T(e),u=arguments.length,s=u>1?arguments[1]:void 0,l=void 0!==s,E=m(c);if(null!=E&&!S(E)){for(a=E.call(c),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);c=r}for(l&&u>2&&(s=_(s,arguments[2],2)),t=0,n=p(c.length),i=ve(this,n);n>t;t++)i[t]=l?s(c[t],t):c[t];return i},Le=function(){for(var e=0,t=arguments.length,n=ve(this,t);t>e;)n[e]=arguments[e++];return n},be=!!V&&o(function(){fe.call(new V(1))}),Me=function(){return fe.apply(be?le.call(Re(this)):Re(this),arguments)},we={copyWithin:function(e,t){return F.call(Re(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return $(Re(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return K.apply(Re(this),arguments)},filter:function(e){return me(this,z(Re(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return Q(Re(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Re(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){q(Re(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(Re(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Re(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return _e.apply(Re(this),arguments)},lastIndexOf:function(e){return ae.apply(Re(this),arguments)},map:function(e){return Oe(Re(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return ce.apply(Re(this),arguments)},reduceRight:function(e){return ue.apply(Re(this),arguments)},reverse:function(){for(var e,t=Re(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return Z(Re(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return se.call(Re(this),e)},subarray:function(e,t){var n=Re(this),r=n.length,i=I(e,r);return new(b(n,n[Ie]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,p((void 0===t?r:I(t,r))-i))}},Ue=function(e,t){return me(this,le.call(Re(this),e,t))},xe=function(e){Re(this);var t=Ne(arguments[1],1),n=this.length,r=T(e),i=p(r.length),o=0;if(i+t>n)throw Y("Wrong length!");for(;o<i;)this[t+o]=r[o++]},Ke={entries:function(){return oe.call(Re(this))},keys:function(){return ie.call(Re(this))},values:function(){return re.call(Re(this))}},Fe=function(e,t){return O(e)&&e[ge]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},je=function(e,t){return Fe(e,t=A(t,!0))?l(2,e[t]):B(e,t)},Ge=function(e,t,n){return!(Fe(e,t=A(t,!0))&&O(n)&&g(n,"value"))||g(n,"get")||g(n,"set")||n.configurable||g(n,"writable")&&!n.writable||g(n,"enumerable")&&!n.enumerable?X(e,t,n):(e[t]=n.value,e)};Ae||(G.f=je,j.f=Ge),a(a.S+a.F*!Ae,"Object",{getOwnPropertyDescriptor:je,defineProperty:Ge}),o(function(){Ee.call({})})&&(Ee=fe=function(){return _e.call(this)});var Xe=f({},we);f(Xe,Ke),E(Xe,Ce,Ke.values),f(Xe,{slice:Ue,set:xe,constructor:function(){},toString:Ee,toLocaleString:Me}),ye(Xe,"buffer","b"),ye(Xe,"byteOffset","o"),ye(Xe,"byteLength","l"),ye(Xe,"length","e"),X(Xe,pe,{get:function(){return this[ge]}}),e.exports=function(e,t,n,u){var _=e+((u=!!u)?"Clamped":"")+"Array",l="get"+e,f="set"+e,C=i[_],I=C||{},A=C&&R(C),g=!C||!c.ABV,T={},S=C&&C.prototype,m=function(e,n){X(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[l](n*t+r.o,Te)}(this,n)},set:function(e){return function(e,n,r){var i=e._d;u&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),i.v[f](n*t+i.o,r,Te)}(this,n,e)},enumerable:!0})};g?(C=n(function(e,n,r,i){s(e,C,_,"_d");var o,a,c,u,l=0,f=0;if(O(n)){if(!(n instanceof W||"ArrayBuffer"==(u=h(n))||"SharedArrayBuffer"==u))return ge in n?Pe(C,n):De.call(C,n);o=n,f=Ne(r,t);var I=n.byteLength;if(void 0===i){if(I%t)throw Y("Wrong length!");if((a=I-f)<0)throw Y("Wrong length!")}else if((a=p(i)*t)+f>I)throw Y("Wrong length!");c=a/t}else c=d(n),o=new W(a=c*t);for(E(e,"_d",{b:o,o:f,l:a,e:c,v:new J(o)});l<c;)m(e,l++)}),S=C.prototype=N(Xe),E(S,"constructor",C)):o(function(){C(1)})&&o(function(){new C(-1)})&&U(function(e){new C,new C(null),new C(1.5),new C(e)},!0)||(C=n(function(e,n,r,i){var o;return s(e,C,_),O(n)?n instanceof W||"ArrayBuffer"==(o=h(n))||"SharedArrayBuffer"==o?void 0!==i?new I(n,Ne(r,t),i):void 0!==r?new I(n,Ne(r,t)):new I(n):ge in n?Pe(C,n):De.call(C,n):new I(d(n))}),q(A!==Function.prototype?v(I).concat(v(A)):v(I),function(e){e in C||E(C,e,I[e])}),C.prototype=S,r||(S.constructor=C));var P=S[Ce],y=!!P&&("values"==P.name||null==P.name),D=Ke.values;E(C,de,!0),E(S,ge,_),E(S,he,!0),E(S,Ie,C),(u?new C(1)[pe]==_:pe in S)||X(S,pe,{get:function(){return _}}),T[_]=C,a(a.G+a.W+a.F*(C!=I),T),a(a.S,_,{BYTES_PER_ELEMENT:t}),a(a.S+a.F*o(function(){I.of.call(C,1)}),_,{from:De,of:Le}),"BYTES_PER_ELEMENT"in S||E(S,"BYTES_PER_ELEMENT",t),a(a.P,_,we),x(_),a(a.P+a.F*Se,_,{set:xe}),a(a.P+a.F*!y,_,Ke),r||S.toString==Ee||(S.toString=Ee),a(a.P+a.F*o(function(){new C(1).slice()}),_,{slice:Ue}),a(a.P+a.F*(o(function(){return[1,2].toLocaleString()!=new C([1,2]).toLocaleString()})||!o(function(){S.toLocaleString.call([1,2])})),_,{toLocaleString:Me}),w[_]=y?P:D,r||y||E(S,Ce,D)}}else e.exports=function(){}},function(e,t,n){"use strict";var r=n(1),i=n(3),o=n(14),a=n(61),c=n(6),u=n(47),_=n(7),s=n(48),l=n(12),E=n(8),f=n(62),C=n(25).f,p=n(5).f,d=n(63),I=n(26),A="prototype",g="Wrong index!",h=r.ArrayBuffer,O=r.DataView,T=r.Math,S=r.RangeError,N=r.Infinity,R=h,v=T.abs,m=T.pow,P=T.floor,y=T.log,D=T.LN2,L=i?"_b":"buffer",b=i?"_l":"byteLength",M=i?"_o":"byteOffset";function w(e,t,n){var r,i,o,a=new Array(n),c=8*n-t-1,u=(1<<c)-1,_=u>>1,s=23===t?m(2,-24)-m(2,-77):0,l=0,E=e<0||0===e&&1/e<0?1:0;for((e=v(e))!=e||e===N?(i=e!=e?1:0,r=u):(r=P(y(e)/D),e*(o=m(2,-r))<1&&(r--,o*=2),(e+=r+_>=1?s/o:s*m(2,1-_))*o>=2&&(r++,o/=2),r+_>=u?(i=0,r=u):r+_>=1?(i=(e*o-1)*m(2,t),r+=_):(i=e*m(2,_-1)*m(2,t),r=0));t>=8;a[l++]=255&i,i/=256,t-=8);for(r=r<<t|i,c+=t;c>0;a[l++]=255&r,r/=256,c-=8);return a[--l]|=128*E,a}function U(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,c=i-7,u=n-1,_=e[u--],s=127&_;for(_>>=7;c>0;s=256*s+e[u],u--,c-=8);for(r=s&(1<<-c)-1,s>>=-c,c+=t;c>0;r=256*r+e[u],u--,c-=8);if(0===s)s=1-a;else{if(s===o)return r?NaN:_?-N:N;r+=m(2,t),s-=a}return(_?-1:1)*r*m(2,s-t)}function x(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function K(e){return[255&e]}function F(e){return[255&e,e>>8&255]}function j(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function G(e){return w(e,52,8)}function X(e){return w(e,23,4)}function B(e,t,n){p(e[A],t,{get:function(){return this[n]}})}function Y(e,t,n,r){var i=f(+n);if(i+t>e[b])throw S(g);var o=e[L]._b,a=i+e[M],c=o.slice(a,a+t);return r?c:c.reverse()}function H(e,t,n,r,i,o){var a=f(+n);if(a+t>e[b])throw S(g);for(var c=e[L]._b,u=a+e[M],_=r(+i),s=0;s<t;s++)c[u+s]=_[o?s:t-s-1]}if(a.ABV){if(!_(function(){h(1)})||!_(function(){new h(-1)})||_(function(){return new h,new h(1.5),new h(NaN),"ArrayBuffer"!=h.name})){for(var V,k=(h=function(e){return s(this,h),new R(f(e))})[A]=R[A],W=C(R),J=0;W.length>J;)(V=W[J++])in h||c(h,V,R[V]);o||(k.constructor=h)}var q=new O(new h(2)),z=O[A].setInt8;q.setInt8(0,2147483648),q.setInt8(1,2147483649),!q.getInt8(0)&&q.getInt8(1)||u(O[A],{setInt8:function(e,t){z.call(this,e,t<<24>>24)},setUint8:function(e,t){z.call(this,e,t<<24>>24)}},!0)}else h=function(e){s(this,h,"ArrayBuffer");var t=f(e);this._b=d.call(new Array(t),0),this[b]=t},O=function(e,t,n){s(this,O,"DataView"),s(e,h,"DataView");var r=e[b],i=l(t);if(i<0||i>r)throw S("Wrong offset!");if(i+(n=void 0===n?r-i:E(n))>r)throw S("Wrong length!");this[L]=e,this[M]=i,this[b]=n},i&&(B(h,"byteLength","_l"),B(O,"buffer","_b"),B(O,"byteLength","_l"),B(O,"byteOffset","_o")),u(O[A],{getInt8:function(e){return Y(this,1,e)[0]<<24>>24},getUint8:function(e){return Y(this,1,e)[0]},getInt16:function(e){var t=Y(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Y(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return x(Y(this,4,e,arguments[1]))},getUint32:function(e){return x(Y(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return U(Y(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return U(Y(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){H(this,1,e,K,t)},setUint8:function(e,t){H(this,1,e,K,t)},setInt16:function(e,t){H(this,2,e,F,t,arguments[2])},setUint16:function(e,t){H(this,2,e,F,t,arguments[2])},setInt32:function(e,t){H(this,4,e,j,t,arguments[2])},setUint32:function(e,t){H(this,4,e,j,t,arguments[2])},setFloat32:function(e,t){H(this,4,e,X,t,arguments[2])},setFloat64:function(e,t){H(this,8,e,G,t,arguments[2])}});I(h,"ArrayBuffer"),I(O,"DataView"),c(O[A],a.VIEW,!0),t.ArrayBuffer=h,t.DataView=O},function(e,t,n){var r=n(5),i=n(2),o=n(21);e.exports=n(3)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),c=a.length,u=0;c>u;)r.f(e,n=a[u++],t[n]);return e}},function(e,t,n){var r=n(17),i=n(42),o=n(9),a=n(8),c=n(85);e.exports=function(e,t){var n=1==e,u=2==e,_=3==e,s=4==e,l=6==e,E=5==e||l,f=t||c;return function(t,c,C){for(var p,d,I=o(t),A=i(I),g=r(c,C,3),h=a(A.length),O=0,T=n?f(t,h):u?f(t,0):void 0;h>O;O++)if((E||O in A)&&(d=g(p=A[O],O,I),e))if(n)T[O]=d;else if(d)switch(e){case 3:return!0;case 5:return p;case 6:return O;case 2:T.push(p)}else if(s)return!1;return l?-1:_||s?s:T}}},function(e,t,n){var r=n(86);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(4),i=n(68),o=n(0)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(0)("unscopables"),i=Array.prototype;null==i[r]&&n(6)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(49),i=n(23),o=n(26),a={};n(6)(a,n(0)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){"use strict";var r=n(9),i=n(37),o=n(8);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),c=i(e,a),u=i(t,a),_=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===_?a:i(_,a))-u,a-c),l=1;for(u<c&&c<u+s&&(l=-1,u+=s-1,c+=s-1);s-- >0;)u in n?n[c]=n[u]:delete n[c],c+=l,u+=l;return n}},function(e,t,n){n(3)&&"g"!=/./g.flags&&n(5).f(RegExp.prototype,"flags",{configurable:!0,get:n(33)})},function(e,t,n){var r=n(17),i=n(93),o=n(64),a=n(2),c=n(8),u=n(67),_={},s={};(t=e.exports=function(e,t,n,l,E){var f,C,p,d,I=E?function(){return e}:u(e),A=r(n,l,t?2:1),g=0;if("function"!=typeof I)throw TypeError(e+" is not iterable!");if(o(I)){for(f=c(e.length);f>g;g++)if((d=t?A(a(C=e[g])[0],C[1]):A(e[g]))===_||d===s)return d}else for(p=I.call(e);!(C=p.next()).done;)if((d=i(p,A,C.value,t))===_||d===s)return d}).BREAK=_,t.RETURN=s},function(e,t,n){var r=n(2);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(1),i=n(72).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,c=r.Promise,u="process"==n(18)(a);e.exports=function(){var e,t,n,_=function(){var r,i;for(u&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(_)};else if(!o||r.navigator&&r.navigator.standalone)if(c&&c.resolve){var s=c.resolve(void 0);n=function(){s.then(_)}}else n=function(){i.call(r,_)};else{var l=!0,E=document.createTextNode("");new o(_).observe(E,{characterData:!0}),n=function(){E.data=l=!l}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(1).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){var r=n(2),i=n(4),o=n(73);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){var r=n(9),i=n(21);n(100)("keys",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(16),i=n(13),o=n(7);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(e,t,n){var r=n(5).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(3)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){var r=n(16);r(r.S+r.F,"Object",{assign:n(103)})},function(e,t,n){"use strict";var r=n(21),i=n(51),o=n(36),a=n(9),c=n(42),u=Object.assign;e.exports=!u||n(7)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r})?function(e,t){for(var n=a(e),u=arguments.length,_=1,s=i.f,l=o.f;u>_;)for(var E,f=c(arguments[_++]),C=s?r(f).concat(s(f)):r(f),p=C.length,d=0;p>d;)l.call(f,E=C[d++])&&(n[E]=f[E]);return n}:u},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(105),core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es7_symbol_async_iterator__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(106),core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_symbol__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(30),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(27),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(24),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es6_promise__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(28),core_js_modules_es6_promise__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es6_promise__WEBPACK_IMPORTED_MODULE_5__);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){if(!window.cadesplugin){var pluginObject,plugin_resolved=0,plugin_reject,plugin_resolve,isOpera=0,isYaBrowser=0,isFireFox=0,failed_extensions=0,canPromise=!!window.Promise,cadesplugin;cadesplugin=canPromise?new Promise(function(e,t){plugin_resolve=e,plugin_reject=t}):{};var ru_cryptopro_npcades_10_native_bridge={callbacksCount:1,callbacks:{},resultForCallback:function(e,t){var n=ru_cryptopro_npcades_10_native_bridge.callbacks[e];n&&n.apply(null,t)},call:function(e,t,n){var r=n&&"function"==typeof n,i=r?ru_cryptopro_npcades_10_native_bridge.callbacksCount++:0;r&&(ru_cryptopro_npcades_10_native_bridge.callbacks[i]=n);var o=document.createElement("IFRAME"),a=new Array("_CPNP_handle");try{o.setAttribute("src","cpnp-js-call:"+e+":"+i+":"+encodeURIComponent(JSON.stringify(t,a)))}catch(e){alert(e)}document.documentElement.appendChild(o),o.parentNode.removeChild(o),o=null}};cadesplugin.JSModuleVersion="2.1.0",cadesplugin.async_spawn=async_spawn,cadesplugin.set=set_pluginObject,cadesplugin.set_log_level=set_log_level,cadesplugin.getLastError=getLastError,isNativeMessageSupported()&&(cadesplugin.CreateObjectAsync=CreateObjectAsync),isNativeMessageSupported()||(cadesplugin.CreateObject=CreateObject),window.cadesplugin_load_timeout?setTimeout(check_load_timeout,window.cadesplugin_load_timeout):setTimeout(check_load_timeout,2e4),set_constantValues(),cadesplugin.current_log_level=cadesplugin.LOG_LEVEL_ERROR,window.cadesplugin=cadesplugin,check_plugin_working()}function cpcsp_console_log(e,t){if("undefined"!=typeof console)return e<=cadesplugin.current_log_level?(e==cadesplugin.LOG_LEVEL_DEBUG&&console.log("DEBUG: %s",t),e==cadesplugin.LOG_LEVEL_INFO&&console.info("INFO: %s",t),void(e==cadesplugin.LOG_LEVEL_ERROR&&console.error("ERROR: %s",t))):void 0}function set_log_level(e){e==cadesplugin.LOG_LEVEL_DEBUG||e==cadesplugin.LOG_LEVEL_INFO||e==cadesplugin.LOG_LEVEL_ERROR?(cadesplugin.current_log_level=e,cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_DEBUG&&cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = DEBUG"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_INFO&&cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = INFO"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_ERROR&&cpcsp_console_log(cadesplugin.LOG_LEVEL_INFO,"cadesplugin_api.js: log_level = ERROR"),isNativeMessageSupported()&&(cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_DEBUG&&window.postMessage("set_log_level=debug","*"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_INFO&&window.postMessage("set_log_level=info","*"),cadesplugin.current_log_level==cadesplugin.LOG_LEVEL_ERROR&&window.postMessage("set_log_level=error","*"))):cpcsp_console_log(cadesplugin.LOG_LEVEL_ERROR,"cadesplugin_api.js: Incorrect log_level: "+e)}function set_constantValues(){cadesplugin.CAPICOM_LOCAL_MACHINE_STORE=1,cadesplugin.CAPICOM_CURRENT_USER_STORE=2,cadesplugin.CADESCOM_LOCAL_MACHINE_STORE=1,cadesplugin.CADESCOM_CURRENT_USER_STORE=2,cadesplugin.CADESCOM_CONTAINER_STORE=100,cadesplugin.CAPICOM_MY_STORE="My",cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED=2,cadesplugin.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1,cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_ENVELOPED=0,cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_ENVELOPING=1,cadesplugin.CADESCOM_XML_SIGNATURE_TYPE_TEMPLATE=2,cadesplugin.XmlDsigGost3410UrlObsolete="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",cadesplugin.XmlDsigGost3411UrlObsolete="http://www.w3.org/2001/04/xmldsig-more#gostr3411",cadesplugin.XmlDsigGost3410Url="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr34102001-gostr3411",cadesplugin.XmlDsigGost3411Url="urn:ietf:params:xml:ns:cpxmlsec:algorithms:gostr3411",cadesplugin.CADESCOM_CADES_DEFAULT=0,cadesplugin.CADESCOM_CADES_BES=1,cadesplugin.CADESCOM_CADES_T=5,cadesplugin.CADESCOM_CADES_X_LONG_TYPE_1=93,cadesplugin.CADESCOM_ENCODE_BASE64=0,cadesplugin.CADESCOM_ENCODE_BINARY=1,cadesplugin.CADESCOM_ENCODE_ANY=-1,cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_CHAIN_EXCEPT_ROOT=0,cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_WHOLE_CHAIN=1,cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY=2,cadesplugin.CAPICOM_CERT_INFO_SUBJECT_SIMPLE_NAME=0,cadesplugin.CAPICOM_CERT_INFO_ISSUER_SIMPLE_NAME=1,cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH=0,cadesplugin.CAPICOM_CERTIFICATE_FIND_SUBJECT_NAME=1,cadesplugin.CAPICOM_CERTIFICATE_FIND_ISSUER_NAME=2,cadesplugin.CAPICOM_CERTIFICATE_FIND_ROOT_NAME=3,cadesplugin.CAPICOM_CERTIFICATE_FIND_TEMPLATE_NAME=4,cadesplugin.CAPICOM_CERTIFICATE_FIND_EXTENSION=5,cadesplugin.CAPICOM_CERTIFICATE_FIND_EXTENDED_PROPERTY=6,cadesplugin.CAPICOM_CERTIFICATE_FIND_APPLICATION_POLICY=7,cadesplugin.CAPICOM_CERTIFICATE_FIND_CERTIFICATE_POLICY=8,cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_VALID=9,cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_NOT_YET_VALID=10,cadesplugin.CAPICOM_CERTIFICATE_FIND_TIME_EXPIRED=11,cadesplugin.CAPICOM_CERTIFICATE_FIND_KEY_USAGE=12,cadesplugin.CAPICOM_DIGITAL_SIGNATURE_KEY_USAGE=128,cadesplugin.CAPICOM_PROPID_ENHKEY_USAGE=9,cadesplugin.CAPICOM_OID_OTHER=0,cadesplugin.CAPICOM_OID_KEY_USAGE_EXTENSION=10,cadesplugin.CAPICOM_EKU_CLIENT_AUTH=2,cadesplugin.CAPICOM_EKU_SMARTCARD_LOGON=5,cadesplugin.CAPICOM_EKU_OTHER=0,cadesplugin.CAPICOM_AUTHENTICATED_ATTRIBUTE_SIGNING_TIME=0,cadesplugin.CADESCOM_AUTHENTICATED_ATTRIBUTE_DOCUMENT_NAME=1,cadesplugin.CADESCOM_AUTHENTICATED_ATTRIBUTE_DOCUMENT_DESCRIPTION=2,cadesplugin.CADESCOM_ATTRIBUTE_OTHER=-1,cadesplugin.CADESCOM_STRING_TO_UCS2LE=0,cadesplugin.CADESCOM_BASE64_TO_BINARY=1,cadesplugin.CADESCOM_DISPLAY_DATA_NONE=0,cadesplugin.CADESCOM_DISPLAY_DATA_CONTENT=1,cadesplugin.CADESCOM_DISPLAY_DATA_ATTRIBUTE=2,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_RC2=0,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_RC4=1,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_DES=2,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_3DES=3,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_AES=4,cadesplugin.CADESCOM_ENCRYPTION_ALGORITHM_GOST_28147_89=25,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA1=0,cadesplugin.CADESCOM_HASH_ALGORITHM_MD2=1,cadesplugin.CADESCOM_HASH_ALGORITHM_MD4=2,cadesplugin.CADESCOM_HASH_ALGORITHM_MD5=3,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_256=4,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_384=5,cadesplugin.CADESCOM_HASH_ALGORITHM_SHA_512=6,cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411=100,cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_256=101,cadesplugin.CADESCOM_HASH_ALGORITHM_CP_GOST_3411_2012_512=102,cadesplugin.LOG_LEVEL_DEBUG=4,cadesplugin.LOG_LEVEL_INFO=2,cadesplugin.LOG_LEVEL_ERROR=1}function async_spawn(e){function t(e,t){var o;try{o=n[e](t)}catch(e){return Promise.reject(e)}return o.done?o.value:Promise.resolve(o.value).then(r,i)}var n=e(Array.prototype.slice.call(arguments,1)),r=t.bind(t,"next"),i=t.bind(t,"throw");return r()}function isIE(){return"Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/Trident\/./i)}function isIOS(){return navigator.userAgent.match(/ipod/i)||navigator.userAgent.match(/ipad/i)||navigator.userAgent.match(/iphone/i)}function isNativeMessageSupported(){var e=navigator.userAgent.match(/chrome/i);return isOpera=navigator.userAgent.match(/opr/i),isYaBrowser=navigator.userAgent.match(/YaBrowser/i),!(!(isFireFox=navigator.userAgent.match(/Firefox/i))||!window.allow_firefox_cadesplugin_async)||null!=e&&(e.length>0||null!=isOpera)}function CreateObject(e){if(isIOS())return call_ru_cryptopro_npcades_10_native_bridge("CreateObject",[e]);if(isIE()){if(e.match(/X509Enrollment/i))try{return document.getElementById("certEnrollClassFactory").CreateObject(e)}catch(e){throw"Для создания обьектов X509Enrollment следует настроить веб-узел на использование проверки подлинности по протоколу HTTPS"}try{return document.getElementById("webClassFactory").CreateObject(e)}catch(t){return new ActiveXObject(e)}}return pluginObject.CreateObject(e)}function decimalToHexString(e){return e<0&&(e=4294967295+e+1),e.toString(16).toUpperCase()}function GetMessageFromException(e){var t=e.message;return t?e.number&&(t+=" (0x"+decimalToHexString(e.number)+")"):t=e,t}function getLastError(e){if(isNativeMessageSupported()||isIE()||isIOS())return GetMessageFromException(e);try{return pluginObject.getLastError()}catch(t){return GetMessageFromException(e)}}function CreateObjectAsync(e){return pluginObject.CreateObjectAsync(e)}function call_ru_cryptopro_npcades_10_native_bridge(functionName,array){var tmpobj,ex;if(ru_cryptopro_npcades_10_native_bridge.call(functionName,array,function(e,response){ex=e;var str="tmpobj="+response;eval(str),"string"==typeof tmpobj&&(tmpobj=tmpobj.replace(/\\\n/gm,"\n"),tmpobj=tmpobj.replace(/\\\r/gm,"\r"))}),ex)throw ex;return tmpobj}function install_opera_extension(){window.cadesplugin_skip_extension_install?plugin_loaded_error("Плагин недоступен"):document.addEventListener("DOMContentLoaded",function(){var e=document.createElement("div");e.id="cadesplugin_ovr",e.style="visibility: hidden; position: fixed; left: 0px; top: 0px; width:100%; height:100%; background-color: rgba(0,0,0,0.7)",e.innerHTML="<div id='cadesplugin_ovr_item' style='position:relative; width:400px; margin:100px auto; background-color:#fff; border:2px solid #000; padding:10px; text-align:center; opacity: 1; z-index: 1500'><button id='cadesplugin_close_install' style='float: right; font-size: 10px; background: transparent; border: 1; margin: -5px'>X</button><p>Для работы КриптоПро ЭЦП Browser plugin на данном сайте необходимо установить расширение из каталога дополнений Opera.<p><button id='cadesplugin_install' style='font:12px Arial'>Установить расширение</button></p></div>",document.getElementsByTagName("Body")[0].appendChild(e),document.getElementById("cadesplugin_install").addEventListener("click",function(e){opr.addons.installExtension("epebfcehmdedogndhlcacafjaacknbcm",function(){document.getElementById("cadesplugin_ovr").style.visibility="hidden",location.reload()},function(){})}),document.getElementById("cadesplugin_close_install").addEventListener("click",function(){plugin_loaded_error("Плагин недоступен"),document.getElementById("cadesplugin_ovr").style.visibility="hidden"}),e.addEventListener("click",function(){plugin_loaded_error("Плагин недоступен"),document.getElementById("cadesplugin_ovr").style.visibility="hidden"}),e.style.visibility="visible",document.getElementById("cadesplugin_ovr_item").addEventListener("click",function(e){e.stopPropagation()})})}function firefox_nmcades_onload(){cpcsp_chrome_nmcades.check_chrome_plugin(plugin_loaded,plugin_loaded_error)}function nmcades_api_onload(){window.postMessage("cadesplugin_echo_request","*"),window.addEventListener("message",function(e){if("string"==typeof e.data&&e.data.match("cadesplugin_loaded"))if(isFireFox){var t=e.data.substring(e.data.indexOf("url:")+4),n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",t),n.onerror=plugin_loaded_error,n.onload=firefox_nmcades_onload,document.getElementsByTagName("head")[0].appendChild(n)}else cpcsp_chrome_nmcades.check_chrome_plugin(plugin_loaded,plugin_loaded_error)},!1)}function load_extension(){if(isFireFox)nmcades_api_onload();else{var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src","chrome-extension://iifchhfnnmpdbibifmljnfjhpififfog/nmcades_plugin_api.js"),e.onerror=plugin_loaded_error,e.onload=nmcades_api_onload,document.getElementsByTagName("head")[0].appendChild(e),(e=document.createElement("script")).setAttribute("type","text/javascript"),e.setAttribute("src","chrome-extension://epebfcehmdedogndhlcacafjaacknbcm/nmcades_plugin_api.js"),e.onerror=plugin_loaded_error,e.onload=nmcades_api_onload,document.getElementsByTagName("head")[0].appendChild(e)}}function load_npapi_plugin(){var e=document.createElement("object");if(e.setAttribute("id","cadesplugin_object"),e.setAttribute("type","application/x-cades"),e.setAttribute("style","visibility: hidden"),document.getElementsByTagName("body")[0].appendChild(e),pluginObject=document.getElementById("cadesplugin_object"),isIE()){var t=document.createElement("object");t.setAttribute("id","certEnrollClassFactory"),t.setAttribute("classid","clsid:884e2049-217d-11da-b2a4-000e7bbb2b09"),t.setAttribute("style","visibility: hidden"),document.getElementsByTagName("body")[0].appendChild(t);var n=document.createElement("object");n.setAttribute("id","webClassFactory"),n.setAttribute("classid","clsid:B04C8637-10BD-484E-B0DA-B8A039F60024"),n.setAttribute("style","visibility: hidden"),document.getElementsByTagName("body")[0].appendChild(n)}}function plugin_loaded(){plugin_resolved=1,canPromise?plugin_resolve():window.postMessage("cadesplugin_loaded","*")}function plugin_loaded_error(e){if(isNativeMessageSupported()){if(++failed_extensions<2)return;if(isOpera&&(void 0===e||"object"==_typeof(e)))return void install_opera_extension()}void 0!==e&&"object"!=_typeof(e)||(e="Плагин недоступен"),plugin_resolved=1,canPromise?plugin_reject(e):window.postMessage("cadesplugin_load_error","*")}function check_load_timeout(){1!=plugin_resolved&&(plugin_resolved=1,canPromise?plugin_reject("Истекло время ожидания загрузки плагина"):window.postMessage("cadesplugin_load_error","*"))}function createPromise(e){return new Promise(e)}function check_npapi_plugin(){try{CreateObject("CAdESCOM.About");plugin_loaded()}catch(t){document.getElementById("cadesplugin_object").style.display="none";var e=navigator.mimeTypes["application/x-cades"];if(e)plugin_loaded_error(e.enabledPlugin?"Плагин загружен, но не создаются обьекты":"Ошибка при загрузке плагина");else plugin_loaded_error("Плагин недоступен")}}function check_plugin_working(){var e=document.createElement("div");e.innerHTML="\x3c!--[if lt IE 9]><iecheck></iecheck><![endif]--\x3e",1==e.getElementsByTagName("iecheck").length?plugin_loaded_error("Internet Explorer версии 8 и ниже не поддерживается"):isNativeMessageSupported()?load_extension():canPromise?window.addEventListener("load",function(e){load_npapi_plugin(),check_npapi_plugin()},!1):window.addEventListener("message",function(e){"cadesplugin_echo_request"==e.data&&(load_npapi_plugin(),check_npapi_plugin())},!1)}function set_pluginObject(e){pluginObject=e}}()},function(e,t,n){n(74)("asyncIterator")},function(e,t,n){"use strict";var r=n(1),i=n(11),o=n(3),a=n(16),c=n(10),u=n(107).KEY,_=n(7),s=n(39),l=n(26),E=n(15),f=n(0),C=n(75),p=n(74),d=n(108),I=n(68),A=n(2),g=n(4),h=n(19),O=n(34),T=n(23),S=n(49),N=n(109),R=n(41),v=n(5),m=n(21),P=R.f,y=v.f,D=N.f,L=r.Symbol,b=r.JSON,M=b&&b.stringify,w=f("_hidden"),U=f("toPrimitive"),x={}.propertyIsEnumerable,K=s("symbol-registry"),F=s("symbols"),j=s("op-symbols"),G=Object.prototype,X="function"==typeof L,B=r.QObject,Y=!B||!B.prototype||!B.prototype.findChild,H=o&&_(function(){return 7!=S(y({},"a",{get:function(){return y(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=P(G,t);r&&delete G[t],y(e,t,n),r&&e!==G&&y(G,t,r)}:y,V=function(e){var t=F[e]=S(L.prototype);return t._k=e,t},k=X&&"symbol"==typeof L.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof L},W=function(e,t,n){return e===G&&W(j,t,n),A(e),t=O(t,!0),A(n),i(F,t)?(n.enumerable?(i(e,w)&&e[w][t]&&(e[w][t]=!1),n=S(n,{enumerable:T(0,!1)})):(i(e,w)||y(e,w,T(1,{})),e[w][t]=!0),H(e,t,n)):y(e,t,n)},J=function(e,t){A(e);for(var n,r=d(t=h(t)),i=0,o=r.length;o>i;)W(e,n=r[i++],t[n]);return e},q=function(e){var t=x.call(this,e=O(e,!0));return!(this===G&&i(F,e)&&!i(j,e))&&(!(t||!i(this,e)||!i(F,e)||i(this,w)&&this[w][e])||t)},z=function(e,t){if(e=h(e),t=O(t,!0),e!==G||!i(F,t)||i(j,t)){var n=P(e,t);return!n||!i(F,t)||i(e,w)&&e[w][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=D(h(e)),r=[],o=0;n.length>o;)i(F,t=n[o++])||t==w||t==u||r.push(t);return r},$=function(e){for(var t,n=e===G,r=D(n?j:h(e)),o=[],a=0;r.length>a;)!i(F,t=r[a++])||n&&!i(G,t)||o.push(F[t]);return o};X||(c((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var e=E(arguments.length>0?arguments[0]:void 0),t=function(n){this===G&&t.call(j,n),i(this,w)&&i(this[w],e)&&(this[w][e]=!1),H(this,e,T(1,n))};return o&&Y&&H(G,e,{configurable:!0,set:t}),V(e)}).prototype,"toString",function(){return this._k}),R.f=z,v.f=W,n(25).f=N.f=Z,n(36).f=q,n(51).f=$,o&&!n(14)&&c(G,"propertyIsEnumerable",q,!0),C.f=function(e){return V(f(e))}),a(a.G+a.W+a.F*!X,{Symbol:L});for(var Q="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Q.length>ee;)f(Q[ee++]);for(var te=m(f.store),ne=0;te.length>ne;)p(te[ne++]);a(a.S+a.F*!X,"Symbol",{for:function(e){return i(K,e+="")?K[e]:K[e]=L(e)},keyFor:function(e){if(!k(e))throw TypeError(e+" is not a symbol!");for(var t in K)if(K[t]===e)return t},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),a(a.S+a.F*!X,"Object",{create:function(e,t){return void 0===t?S(e):J(S(e),t)},defineProperty:W,defineProperties:J,getOwnPropertyDescriptor:z,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),b&&a(a.S+a.F*(!X||_(function(){var e=L();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(g(t)||void 0!==e)&&!k(e))return I(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!k(t))return t}),r[1]=t,M.apply(b,r)}}),L.prototype[U]||n(6)(L.prototype,U,L.prototype.valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(e,t,n){var r=n(15)("meta"),i=n(4),o=n(11),a=n(5).f,c=0,u=Object.isExtensible||function(){return!0},_=!n(7)(function(){return u(Object.preventExtensions({}))}),s=function(e){a(e,r,{value:{i:"O"+ ++c,w:{}}})},l=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!u(e))return"F";if(!t)return"E";s(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!u(e))return!0;if(!t)return!1;s(e)}return e[r].w},onFreeze:function(e){return _&&l.NEED&&u(e)&&!o(e,r)&&s(e),e}}},function(e,t,n){var r=n(21),i=n(51),o=n(36);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,c=n(e),u=o.f,_=0;c.length>_;)u.call(e,a=c[_++])&&t.push(a);return t}},function(e,t,n){var r=n(19),i=n(25).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},function(e,t,n){"use strict";n.r(t);n(30);function r(){}r.prototype.toString=function(){var e="";for(var t in this)this.hasOwnProperty(t)&&(e+=t+'="'+this[t].replace(/"/g,"")+'", ');return e};var i=r,o=(n(24),n(58),n(46),n(27),n(28),{CKR_CANCEL:"пользователь отказался от выполнения операции.",CKR_HOST_MEMORY:"недостаточно памяти для выполнения функции.",CKR_SLOT_ID_INVALID:"неправильный идентификатор слота.",CKR_GENERAL_ERROR:"Критическая ошибка, связанная с аппаратным обеспечением; Неудачная попытка проверки пути сертификации.",CKR_FUNCTION_FAILED:"при выполнении функции возник сбой.",CKR_ARGUMENTS_BAD:"недопустимый аргумент.",CKR_ATTRIBUTE_READ_ONLY:"предпринята попытка присвоения значения атрибуту, который нельзя изменять.",CKR_ATTRIBUTE_TYPE_INVALID:"некорректный тип атрибута.",CKR_ATTRIBUTE_VALUE_INVALID:"атрибут нулевой длины.",CKR_DEVICE_ERROR:"ошибка при обращении к устройству или слоту.",CKR_DEVICE_MEMORY:"для выполнения функции недостаточно памяти в устройстве.",CKR_FUNCTION_CANCELED:"время ожидания выполнения функции истекло.",CKR_KEY_HANDLE_INVALID:"функции передан некорректный дескриптор ключа.",CKR_KEY_SIZE_RANGE:"недопустимый размер ключа.",CKR_KEY_TYPE_INCONSISTENT:"данный тип ключа не может использоваться с данным механизмом.",CKR_MECHANISM_INVALID:"при выполнении криптографической функции был указан неправильный механизм.",CKR_MECHANISM_PARAM_INVALID:"при выполнении криптографической функции были заданы некорректные параметры механизма.",CKR_OBJECT_HANDLE_INVALID:"функции передан некорректный дескриптор объекта.",CKR_OPERATION_ACTIVE:"одна или несколько выполняющихся операций препятствуют выполнению новой операции.",CKR_OPERATION_NOT_INITIALIZED:"выполнение операции без предварительного указания параметров невозможно.",CKR_PIN_INCORRECT:"функции передан неверный PIN-код.",CKR_PIN_LEN_RANGE:"недопустимая длина PIN-кода.",CKR_PIN_LOCKED:"PIN-код заблокирован.",CKR_SESSION_HANDLE_INVALID:"функции передан некорректный дескриптор сессии.",CKR_SESSION_PARALLEL_NOT_SUPPORTED:"невозможно открыть параллельную сессию.",CKR_SESSION_EXISTS:"уже открыта сессия работы с тем же устройством.",CKR_SESSION_READ_ONLY_EXISTS:"сессия открыта только для чтения. Смена режима невозможна.",CKR_SESSION_READ_WRITE_SO_EXISTS:"открыта сессия чтения/записи. Открыть сеанс только для чтения невозможно.",CKR_SIGNATURE_INVALID:"неправильное значение электронной подписи.",CKR_TEMPLATE_INCOMPLETE:"для создания объекта недостаточно атрибутов.",CKR_TOKEN_NOT_PRESENT:"в момент выполнения функции устройство было отключено.",CKR_TOKEN_WRITE_PROTECTED:"устройство недоступно для записи.",CKR_USER_ALREADY_LOGGED_IN:"пользователь уже предъявил PIN-код.",CKR_USER_NOT_LOGGED_IN:"функция не может быть выполнена в гостевом режиме работы устройства.",CKR_USER_PIN_NOT_INITIALIZED:"начальное значение PIN-кода не установлено.",CKR_USER_TYPE_INVALID:"функция не может быть выполнена в текущем режиме работы устройства.",CKR_USER_ANOTHER_ALREADY_LOGGED_IN:"невозможно переключение из режима администратора в режим пользователя или обратно.",CKR_BUFFER_TOO_SMALL:"размер заданного буфера является недостаточным для сохранения результатов функции.",CKR_INFORMATION_SENSITIVE:"запрашиваемый объект недоступен для чтения.",CKR_CRYPTOKI_NOT_INITIALIZED:"выполнение функции без инициализации Единой библиотеки PKCS#11 (библиотеки Cryptoki) невозможно.",CKR_CRYPTOKI_ALREADY_INITIALIZED:"попытка повторно инициализировать библиотеку Cryptoki.",CKR_FUNCTION_REJECTED:"пользователь отменил операцию.",NOT_STATE_TOKEN_BINDED:"значение параметра state отличается от STATE_TOKEN_BINDED (1).",NOT_STATE_NOT_BINDED:"значение параметра state отличается от STATE_TOKEN_BINDED (0).",IS_STATE_NOT_BINDED:"параметр state принимает значение STATE_TOKEN_BINDED (0).",NOT_STATE_UNILATERAL_AUTHENTICATION_IN_PROGRESS:"значение параметра state отличается от STATE_TOKEN_BINDED (4).",NOT_STATE_SECURE_CHANNEL_CONNECTION_IN_PROGRESS:"значение параметра state отличается от STATE_TOKEN_BINDED (2).",NOT_STATE_SECURE_CHANNEL_ESTABLISHED:"значение параметра state отличается от STATE_TOKEN_BINDED (3).",CERTIFICATE_NOT_FOUND:"сертификат не обнаружен.",PUBLIC_KEY_NOT_FOUND:"открытый ключ не обнаружен в памяти поддерживаемого устройства.",SERVER_PUBLIC_KEY_NOT_FOUND:"не найден открытый ключ сервера.",INVALID_SERVER_PUBLIC_KEY:"неверный открытый ключ сервера.",DATA_TO_SIGN_ZERO_LENGTH:"на подпись были представлены данные, имеющие нулевую длину.",DATA_TO_VERIFY_ZERO_LENGTH:"на проверку подписи были представлены данные, имеющие нулевую длину.",SIGNATURE_TO_VERIFY_ZERO_LENGTH:"на проверку была представлена подпись, имеющая нулевую длину.",INVALID_EC_PARAMS:"неверно заданы параметры криптографических преобразований по ГОСТ Р 34.10-2001.",TOKEN_MEMORY_TOO_SMALL:"для выполнения операции в поддерживаемом устройстве недостаточно свободной памяти.",KEY_SIZE_NOT_64:"длина ключа не равна 64 битам.",CERT_NOT_MATCH_PUBLIC_KEY:"сертификат не соответствует открытому ключу.",FAILED_CHECK_BROWSER_VERS:"ошибка проверки версии используемого браузера.",BROWSER_VERS_NOT_SUPPORTED:"используемая версия браузера не поддерживается.",INVALID_USER_TYPE:"неверно указан тип PIN-кода.",PINS_NOT_MATCH:"введённые значения нового PIN-кода неодинаковы.",USER_CHANGE_ADMIN_PIN_NOT_STATE_NOT_BINDED:"cмена PIN-кода администратора невозможна, поскольку значение параметра state отличается от STATE_TOKEN_BINDED (0).",SSL_ERR_GEN_SESSION_KEY:"ошибка при генерации ключа защиты данных, передаваемых между клиентом и сервером.",SSL_ERR_GOST_ENGINE:"ошибка средства защиты, программно выполняющего криптографические преобразования на стороне клиента.",SSL_ERR_SSL_NEW:"ошибка в начале выполнения протокола Handshake.",SSL_ERR_CONNECT:"ошибка при выполнении протокола Handshake.",SSL_ERR_SSL_WRITE:"ошибка при подготовке данных к защищённой передаче.",SSL_ERR_SSL_READ:"ошибка при чтении защищённых для передачи данных.",SSL_ERR_LOAD_CERT_AND_KEY_FROM_TOKEN:"ошибка при попытке считать сертификат и открытый ключ из памяти поддерживаемого устройства.",SSL_ERR_GET_PEER_PUBLIC_KEY:"ошибка при получении открытого ключа сервера.",CERT_PARS_ERR_GET_PUBLIC_KEY:"не удалось считать открытый ключ из сертификата.",CERT_PARS_ERR_GET_ISSUER_AND_SER_NUMBER:"не удалось считать имя удостоверяющего центра и серийный номер из сертификата.",UNKNOWN_ERROR:"неизвестная ошибка."});n(38),n(22),n(99);function a(e){for(var t=new i,n=["ИНН","КПП","ОГРН","ОГРНИП","СНИЛС"],r=["INN","KPP","OGRN","OGRNIP","SNILS"],o=Object.keys(e),a=0;a<o.length;a++){var c=o[a],u=n.indexOf(c);u>-1?t[r[u]]=e[c]:t[c]=e[c]}return t}var c=function(){var e,t;function n(t){try{if(!t){var n=e.getLastError();t=e.getErrorMessage(n)}return"CKR_OK"!=t&&(o[t]||t)}catch(e){return e.message}}function r(e,t){var n=new i;for(var r in e.Data.Subject){var o=e.Data.Subject[r].rdn,a=e.Data.Subject[r].value;n[o]=a}return n.toString=function(){var e=this.CN||this["2.5.4.3"],n=this["СНИЛС"]||this.SNILS||this["1.2.643.100.3"],r=this["ИНН"]||this.INN||this["1.2.643.3.131.1.1"];return e+(r?"; ИНН "+r:"")+(n?"; СНИЛС "+n:"")+(t?" ("+t+")":"")},n.toString()}function c(e){return("0"+e.toString(16)).slice(-2)}function u(e){var t=new RegExp(".{1,64}","g");return e.match(t).join("\n")}this.init=function(){return new Promise(function(e,t){"undefined"!=typeof JCWebClient?e():function(e,t,n){var r=document.getElementsByTagName("body")[0],i=document.createElement("script");function o(e){r.removeChild(i),n(e)}i.type="text/javascript",i.src=e,i.readyState?i.onreadystatechange=function(){"loaded"===i.readyState||"complete"===i.readyState?(i.onreadystatechange=null,"undefined"==typeof JCWebClient?o("JCWebClient is invalid"):t()):"loading"!==i.readyState&&o("JCWebClient hasn't been loaded")}:(i.onload=t,i.onerror=function(){o("JCWebClient hasn't been loaded")}),r.appendChild(i)}("https://localhost:24738/JCWebClient.js",e,t)}).then(function(){return new Promise(function(r){try{if("undefined"==typeof JCWebClient)throw new Error("Не установлен клиент ни старой, ни новой версии JC-WebClient");if(void 0!==JCWebClient.id)throw new Error("JaCarta WebClient 2.x не поддерживается");if((e=JCWebClient()).initialize(),!e.checkWebBrowserVersion())throw new Error("Браузер не поддерживается");var i=e.getAllTokens();if(!i||1!=i.length)throw i&&i.length>1?new Error("Подключено "+i.length+" токена(ов)"):new Error("Нет подключенных токенов");t=i.shift();var o=e.getPluginVersion(),a=e.getTokenInfo(t);r({version:o,serial:a[0],flags:a[1],label:a[2],type:a[3]})}catch(e){var c=n();throw new Error(e.message||c)}})})},this.bind=function(r){return new Promise(function(i){try{if(1===e.getLoggedInState().shift())i();else if(r)e.bindTokenAsync(t,r,function(e){if(e&&"Error"==e[0]){var t=n(e[1]);throw new Error(t)}i()});else{if(!e.bindTokenUI(t))throw new Error("Пользователь отменил ввод PIN-кода");i()}}catch(e){var o=n();throw new Error(o||e.message)}})},this.unbind=function(){return new Promise(function(t){try{1===e.getLoggedInState().shift()&&e.unbindToken(),t()}catch(e){var r=n();throw new Error(r||e.message)}})},this.clean=function(){return new Promise(function(r){try{var i=e.getCertificateList(t);for(var o in i){var a=i[o].shift();e.deleteContainerOrCertificate(a)}r(o)}catch(e){var c=n();throw new Error(c||e.message)}})},this.generateCSR=function(t,r,i,o){return i&&i.length||(i=["1.3.6.1.5.5.7.3.2","1.3.6.1.5.5.7.3.4"]),o||(o="XA"),new Promise(function(a){try{e.createContainerAsync(o,r,function(r){if(r&&"Error"==r[0]){var o=n(r[1]);throw new Error(o)}var c=r,_=[];for(var s in t)t.hasOwnProperty(s)&&_.push(s,t[s]);var l=["certificatePolicies","1.2.643.100.113.1","keyUsage","digitalSignature,keyEncipherment,nonRepudiation,dataEncipherment","extendedKeyUsage",i.toString(),"1.2.643.100.111",'ASN1:FORMAT:UTF8,UTF8:"Криптотокен" (АЛАДДИН Р.Д.)'];e.genCSRAsync(c,_,l,function(e){if(e&&"Error"==e[0]){var t=n(e[1]);throw new Error(t)}var r=btoa(String.fromCharCode.apply(null,new Uint8Array(e)));a({csr:u(r),containerId:c})})})}catch(e){var c=n();throw new Error(c||e.message)}})},this.writeCertificate=function(t,r){return new Promise(function(i){try{for(var o=[],a=atob(t),c=0;c<a.length;c++)o[c]=a.charCodeAt(c);e.writeCertificateAsync(r,o,function(){i()})}catch(e){var u=n();throw new Error(u||e.message)}})},this.certificateInfo=function(r){return new Promise(function(o){try{var u=e.parseX509CertificateEx(t,r),_=new i;for(var s in u.Data.Subject){var l=u.Data.Subject[s].rdn,E=u.Data.Subject[s].value;_[l]=E}_=a(_);var f=new i;for(var s in u.Data.Issuer)l=u.Data.Issuer[s].rdn,E=u.Data.Issuer[s].value,f[l]=E;var C=new Date;o({Name:_.CN,Issuer:f,IssuerName:f.CN,Subject:_,SubjectName:_.toString(),Version:u.Data.Version,SerialNumber:u.Data["Serial Number"].map(c).join(""),Thumbprint:u.Signature.map(c).join(""),ValidFromDate:u.Data.Validity["Not Before"],ValidToDate:u.Data.Validity["Not After"],HasPrivateKey:!0,IsValid:C>=u.Data.Validity["Not Before"]&&C<=u.Data.Validity["Not After"],toString:function(){return"Название:              "+this.Name+"\nИздатель:              "+this.IssuerName+"\nСубъект:               "+this.SubjectName+"\nВерсия:                "+this.Version+"\nСерийный №:            "+this.SerialNumber+"\nОтпечаток SHA1:        "+this.Thumbprint+"\nНе действителен до:    "+this.ValidFromDate+"\nНе действителен после: "+this.ValidToDate+"\nПриватный ключ:        "+(this.HasPrivateKey?"Есть":"Нет")+"\nВалидный:              "+(this.IsValid?"Да":"Нет")}})}catch(e){var p=n();throw new Error(p||e.message)}})},this.listCertificates=function(){return new Promise(function(i){try{e.getCertificateListAsync(t,function(o){if(o&&"Error"==o[0]){var a=n(o[1]);throw new Error(a)}for(var c=[],u=0;u<o.length;u++){var _=o[u][0],s=o[u][1];try{var l=r(e.parseX509CertificateEx(t,contId),s);c.push({id:_,name:l})}catch(e){console.log("Certificate (%s) info error: %s",contId,e.message)}}i(c)})}catch(e){var o=n();throw new Error(o||e.message)}})},this.readCertificate=function(r){return new Promise(function(i){try{if(0===e.getLoggedInState().shift())var o=e.readCertificateEx(t,r);else o=e.readCertificate(r);if(!o||!o.length)throw new Error("Нет сертификата в контейнере");i(u(btoa(String.fromCharCode.apply(null,new Uint8Array(o)))))}catch(e){var a=n();throw new Error(a||e.message)}})},this.signData=function(t,r){return new Promise(function(i){try{e.signBase64EncodedDataAsync(r,t,!1,!1,function(e){if(e&&"Error"==e[0]){var t=n(e[1]);throw new Error(t)}var r=u(e);i(r)})}catch(e){var o=n();throw new Error(o||e.message)}})}},u=(n(101),n(50),n(102),{UNKNOWN_ERROR:"неизвестная ошибка",CKR_CANCEL:"пользователь отказался от выполнения операции",CKR_HOST_MEMORY:"недостаточно памяти для выполнения функции",CKR_SLOT_ID_INVALID:"неправильный идентификатор слота",CKR_GENERAL_ERROR:"такой код ошибки может означать: критическую ошибку, связанную с аппаратным обеспечением; неудачную попытку проверки пути сертификации.",CKR_FUNCTION_NOT_SUPPORTED:"функция не поддерживается",CKR_FUNCTION_FAILED:"при выполнении функции возник сбой",CKR_ARGUMENTS_BAD:"недопустимый аргумент",CKR_ATTRIBUTE_READ_ONLY:"предпринята попытка присвоения значения атрибуту, который нельзя изменять",CKR_ATTRIBUTE_TYPE_INVALID:"некорректный тип атрибута",CKR_ATTRIBUTE_VALUE_INVALID:"атрибут нулевой длины",CKR_DEVICE_ERROR:"ошибка при обращении к устройству или слоту",CKR_DEVICE_MEMORY:"для выполнения функции недостаточно памяти в устройстве",CKR_FUNCTION_CANCELED:"время ожидания выполнения функции истекло",CKR_KEY_HANDLE_INVALID:"функции передан некорректный дескриптор ключа",CKR_KEY_SIZE_RANGE:"недопустимый размер ключа",CKR_KEY_TYPE_INCONSISTENT:"данный тип ключа не может использоваться с данным механизмом",CKR_MECHANISM_INVALID:"при выполнении криптографической функции был указан неправильный механизм",CKR_MECHANISM_PARAM_INVALID:"при выполнении криптографической функции были заданы некорректные параметры механизма",CKR_OBJECT_HANDLE_INVALID:"функции передан некорректный дескриптор объекта",CKR_OPERATION_ACTIVE:"одна или несколько выполняющихся операций препятствуют выполнению новой операции",CKR_OPERATION_NOT_INITIALIZED:"выполнение операции без предварительного указания параметров невозможно",CKR_PIN_INCORRECT:"функции передан неверный PIN-код",CKR_PIN_LEN_RANGE:"недопустимая длина PIN-кода",CKR_PIN_LOCKED:"PIN-код заблокирован",CKR_SESSION_HANDLE_INVALID:"функции передан некорректный дескриптор сессии",CKR_SESSION_PARALLEL_NOT_SUPPORTED:"невозможно открыть параллельную сессию",CKR_SESSION_EXISTS:"уже открыта сессия работы с тем же устройством",CKR_SESSION_READ_ONLY_EXISTS:"сессия открыта только для чтения. Смена режима невозможна",CKR_SESSION_READ_WRITE_SO_EXISTS:"открыта сессия чтения/записи. Открыть сеанс только для чтения невозможно",CKR_SIGNATURE_INVALID:"неправильное значение электронной подписи",CKR_TEMPLATE_INCOMPLETE:"для создания объекта недостаточно атрибутов",CKR_TOKEN_NOT_PRESENT:"в момент выполнения функции устройство было отключено",CKR_TOKEN_WRITE_PROTECTED:"устройство недоступно для записи",CKR_USER_ALREADY_LOGGED_IN:"пользователь уже предъявил PIN-код",CKR_USER_NOT_LOGGED_IN:"функция не может быть выполнена в гостевом режиме работы устройства",CKR_USER_PIN_NOT_INITIALIZED:"начальное значение PIN-кода не установлено",CKR_USER_TYPE_INVALID:"функция не может быть выполнена в текущем режиме работы устройства",CKR_USER_ANOTHER_ALREADY_LOGGED_IN:"невозможно переключение из режима администратора в режим пользователя или обратно",CKR_BUFFER_TOO_SMALL:"размер заданного буфера является недостаточным для сохранения результатов функции",CKR_INFORMATION_SENSITIVE:"запрашиваемый объект недоступен для чтения",CKR_CRYPTOKI_NOT_INITIALIZED:"выполнение функции без инициализации Единой библиотеки PKCS#11 (библиотеки Cryptoki) невозможно",CKR_CRYPTOKI_ALREADY_INITIALIZED:"попытка повторно инициализировать библиотеку Cryptoki",CKR_FUNCTION_REJECTED:"пользователь отменил операцию",NOT_STATE_TOKEN_BINDED:"значение параметра state отличается от STATE_TOKEN_BINDED (1)",NOT_STATE_NOT_BINDED:"значение параметра state отличается от STATE_TOKEN_BINDED (0)",IS_STATE_NOT_BINDED:"параметр state принимает значение STATE_TOKEN_BINDED (0)",NOT_STATE_UNILATERAL_AUTHENTICATION_IN_PROGRESS:"значение параметра state отличается от STATE_TOKEN_BINDED (4)",NOT_STATE_SECURE_CHANNEL_CONNECTION_IN_PROGRESS:"значение параметра state отличается от STATE_TOKEN_BINDED (2)",NOT_STATE_SECURE_CHANNEL_ESTABLISHED:"значение параметра state отличается от STATE_TOKEN_BINDED (3)",CERTIFICATE_NOT_FOUND:"сертификат не обнаружен",PUBLIC_KEY_NOT_FOUND:"открытый ключ не обнаружен в памяти поддерживаемого устройства",SERVER_PUBLIC_KEY_NOT_FOUND:"не найден открытый ключ сервера",INVALID_SERVER_PUBLIC_KEY:"неверный открытый ключ сервера",DATA_TO_SIGN_ZERO_LENGTH:"на подпись были представлены данные, имеющие нулевую длину",DATA_TO_VERIFY_ZERO_LENGTH:"на проверку подписи были представлены данные, имеющие нулевую длину",SIGNATURE_TO_VERIFY_ZERO_LENGTH:"на проверку была представлена подпись, имеющая нулевую длину",INVALID_EC_PARAMS:"неверно заданы параметры криптографических преобразований по ГОСТ Р 34.10-2001",TOKEN_MEMORY_TOO_SMALL:"для выполнения операции в поддерживаемом устройстве недостаточно свободной памяти",KEY_SIZE_NOT_64:"длина ключа не равна 64 битам",CERT_NOT_MATCH_PUBLIC_KEY:"сертификат не соответствует открытому ключу",FAILED_CHECK_BROWSER_VERS:"ошибка проверки версии используемого браузера",BROWSER_VERS_NOT_SUPPORTED:"используемая версия браузера не поддерживается",INVALID_USER_TYPE:"неверно указан тип PIN-кода",PINS_NOT_MATCH:"введённые значения нового PIN-кода неодинаковы",USER_CHANGE_ADMIN_PIN_NOT_STATE_NOT_BINDED:"cмена PIN-кода администратора невозможна, поскольку значение параметра state отличается от STATE_TOKEN_BINDED (0)",SSL_ERR_GEN_SESSION_KEY:"ошибка при генерации ключа защиты данных, передаваемых между клиентом и сервером",SSL_ERR_GOST_ENGINE:"ошибка средства защиты, программно выполняющего криптографические преобразования на стороне клиента",SSL_ERR_SSL_NEW:"ошибка в начале выполнения протокола Handshake",SSL_ERR_CONNECT:"ошибка при выполнении протокола Handshake",SSL_ERR_SSL_WRITE:"ошибка при подготовке данных к защищённой передаче",SSL_ERR_SSL_READ:"ошибка при чтении защищённых для передачи данных",SSL_ERR_LOAD_CERT_AND_KEY_FROM_TOKEN:"ошибка при попытке считать сертификат и открытый ключ из памяти поддерживаемого устройства",SSL_ERR_GET_PEER_PUBLIC_KEY:"ошибка при получении открытого ключа сервера",CERT_PARS_ERR_GET_PUBLIC_KEY:"не удалось считать открытый ключ из сертификата",CERT_PARS_ERR_GET_ISSUER_AND_SER_NUMBER:"не удалось считать имя удостоверяющего центра и серийный номер из сертификата",CKR_KT2_PIN_ALREADY_SET:"PIN-код уже установлен",CKR_PUK_INCORRECT:"неправильный PUK-код",CKR_CANNOT_UNLOCK:"невозможно разблокировать PIN-код",CKR_PUK_INVALID:"недопустимые символы в значении PUK-кода",CKR_SM_REQUIRED:"для выполнения команды необходимо установить защищённое соединение",CKR_PKCS7_PUBLIC_KEY_NOT_FOUND:"при проверке подписи под PKCS #7 на JaCarta-2 ГОСТ не был найден открытый ключ",CKR_ICL_LIBRARY_NOT_FOUND:"ИКБ не найдена",CKR_ICL_JCVERIFY_NOT_FOUND:"утилита jcverify не найдена",CKR_ICL_JCVERIFY_CHECKSUM_NOT_FOUND:"файл контрольных сумм jcverify не найден",CKR_ICL_CHECKSUM_NOT_FOUND:"файл контрольных сумм ИКБ не найден",CKR_ICL_JCVERIFY_CHECKSUM:"неверные контрольная сумма утилиты jcverify",CKR_ICL_CHECKSUM:"неверная контрольная сумма ИКБ",CKR_ICL_NOT_ICL:"при загрузке ИКБ произошла ошибка. Требуемые функции найдены"});var _=function(){var e,t;function n(t){return function(n){e&&"JCWebClientError"===n.name&&u[n.message]&&(n.message=u[n.message]),t(n)}}function r(e,t){var n=new i;for(var r in e.Data.Subject){var o=e.Data.Subject[r].rdn,a=e.Data.Subject[r].value;n[o]=a}return n.toString=function(){var e=this.CN||this["2.5.4.3"],n=this["СНИЛС"]||this.SNILS||this["1.2.643.100.3"],r=this["ИНН"]||this.INN||this["1.2.643.3.131.1.1"];return e+(r?"; ИНН "+r:"")+(n?"; СНИЛС "+n:"")+(t?" ("+t+")":"")},n.toString()}function o(e){return("0"+e.toString(16)).slice(-2)}function c(e){var t=new RegExp(".{1,64}","g");return e.match(t).join("\n")}this.init=function(){var r={};return new Promise(function(e,t){"undefined"!=typeof JCWebClient2?e():function(e,t,n){var r=document.getElementsByTagName("body")[0],i=document.createElement("script");function o(e){r.removeChild(i),n(e)}i.type="text/javascript",i.src=e,i.readyState?i.onreadystatechange=function(){"loaded"===i.readyState||"complete"===i.readyState?(i.onreadystatechange=null,"undefined"==typeof JCWebClient2?o("JCWebClient is invalid"):t()):"loading"!==i.readyState&&o("JCWebClient hasn't been loaded")}:(i.onload=t,i.onerror=function(){o("JCWebClient hasn't been loaded")}),r.appendChild(i)}("https://localhost:24738/JCWebClient.js",e,t)}).then(function(){return new Promise(function(t,r){if("undefined"==typeof JCWebClient2)throw new Error("Не установлен клиент JCWebClient2");(e=JCWebClient2).initialize(),e.defaults({async:!0}),e.getJCWebClientVersion({onSuccess:t,onError:n(r)})})}).then(function(t){return console.log("JCWebClient2 v.%s",t),r.version=t,new Promise(function(t,r){e.getAllSlots({onSuccess:t,onError:n(r)})})}).then(function(e){return new Promise(function(t,n){var r=e.filter(function(e){return e.tokenExists});if(!r||1!=r.length)throw r&&r.length>1?new Error("Подключено "+r.length+" токена(ов)"):new Error("Нет подключенных токенов");t(r.shift().id)})}).then(function(r){return t=r,new Promise(function(r,i){e.getTokenInfo({args:{tokenID:t},onSuccess:r,onError:n(i)})})}).then(function(e){return Object.assign(r,e)})},this.bind=function(r){return new Promise(function(t,r){e.getLoggedInState({onSuccess:t,onError:n(r)})}).then(function(i){return i.state===JCWebClient2.Vars.AuthState.binded&&i.tokenID===t||new Promise(function(i,o){var a={tokenID:t};r?a.pin=r:a.useUI=!0,e.bindToken({args:a,onSuccess:i,onError:n(o)})})})},this.unbind=function(){return new Promise(function(t,r){e.getLoggedInState({onSuccess:t,onError:n(r)})}).then(function(t){return t.state===JCWebClient2.Vars.AuthState.notBinded||new Promise(function(t,r){e.unbindToken({onSuccess:t,onError:n(r)})})})},this.clean=function(){return new Promise(function(r,i){e.getContainerList({args:{tokenID:t},onSuccess:r,onError:n(i)})}).then(function(t){var r=[];for(var i in t)r.push(new Promise(function(r,o){e.deletePKIObject({args:{id:t[i].id},onSuccess:r,onError:n(o)})}));return Promise.all(r)})},this.generateCSR=function(t,r,i,o){i&&i.length||(i=["1.3.6.1.5.5.7.3.2","1.3.6.1.5.5.7.3.4"]),o||(o=JCWebClient2.Vars.KeyAlgorithm.GOST_2012_256);var a,u={certificatePolicies:"1.2.643.100.113.1",keyUsage:"digitalSignature,keyEncipherment,nonRepudiation,dataEncipherment",extendedKeyUsage:i.toString(),"1.2.643.100.111":'ASN1:FORMAT:UTF8,UTF8:"Криптотокен" (АЛАДДИН Р.Д.)'};return new Promise(function(t,i){e.createKeyPair({args:{paramSet:"XA",description:r,algorithm:o},onSuccess:t,onError:n(i)})}).then(function(r){return a=r,new Promise(function(r,i){e.genCSR({args:{id:a,dn:t,exts:u},onSuccess:r,onError:n(i)})})}).then(function(e){return{csr:c(btoa(String.fromCharCode.apply(null,new Uint8Array(e)))),keyPairId:a}})},this.writeCertificate=function(t,r){return new Promise(function(i,o){e.writeUserCertificate({args:{keyPairID:r,cert:t},onSuccess:i,onError:n(o)})})},this.certificateInfo=function(r){return new Promise(function(i,o){e.parseX509Certificate({args:{tokenID:t,id:r},onSuccess:i,onError:n(o)})}).then(function(e){var t=new i;for(var n in e.Data.Subject){var r=e.Data.Subject[n].rdn,c=e.Data.Subject[n].value;t[r]=c}t=a(t);var u=new i;for(var n in e.Data.Issuer)r=e.Data.Issuer[n].rdn,c=e.Data.Issuer[n].value,u[r]=c;var _=new Date;return{Name:t.CN,Issuer:u,IssuerName:u.CN,Subject:t,SubjectName:t.toString(),Version:e.Data.Version,SerialNumber:e.Data["Serial Number"].map(o).join(""),Thumbprint:e.Signature.map(o).join(""),ValidFromDate:e.Data.Validity["Not Before"],ValidToDate:e.Data.Validity["Not After"],HasPrivateKey:!0,IsValid:_>=e.Data.Validity["Not Before"]&&_<=e.Data.Validity["Not After"],toString:function(){return"Название:              "+this.Name+"\nИздатель:              "+this.IssuerName+"\nСубъект:               "+this.SubjectName+"\nВерсия:                "+this.Version+"\nСерийный №:            "+this.SerialNumber+"\nОтпечаток SHA1:        "+this.Thumbprint+"\nНе действителен до:    "+this.ValidFromDate+"\nНе действителен после: "+this.ValidToDate+"\nПриватный ключ:        "+(this.HasPrivateKey?"Есть":"Нет")+"\nВалидный:              "+(this.IsValid?"Да":"Нет")}}})},this.listCertificates=function(){return new Promise(function(r,i){e.getContainerList({args:{tokenID:t},onSuccess:r,onError:n(i)})}).then(function(i){for(var o=[],a=0;a<i.length;a++)!function(i,a){o.push(new Promise(function(r,o){e.parseX509Certificate({args:{tokenID:t,id:i},onSuccess:r,onError:n(o)})}).then(function(e){return{id:i,name:r(e,a)}}))}(i[a].id,i[a].description);return Promise.all(o)})},this.readCertificate=function(r){return new Promise(function(i,o){e.getCertificateBody({args:{id:r,tokenID:t},onSuccess:i,onError:n(o)})}).then(function(e){if(e&&e.length)return c(btoa(String.fromCharCode.apply(null,new Uint8Array(e))));throw new Error("Нет сертификата в контейнере")})},this.signData=function(t,r){return new Promise(function(i,o){e.signBase64EncodedData({args:{contID:r,data:t},onSuccess:i,onError:n(o)})}).then(function(e){return c(e)})}},s={XCN_AT_NONE:0,XCN_AT_KEYEXCHANGE:1,XCN_AT_SIGNATURE:2},l={XCN_NCRYPT_ALLOW_EXPORT_NONE:0,XCN_NCRYPT_ALLOW_EXPORT_FLAG:1,XCN_NCRYPT_ALLOW_PLAINTEXT_EXPORT_FLAG:2,XCN_NCRYPT_ALLOW_ARCHIVING_FLAG:4,XCN_NCRYPT_ALLOW_PLAINTEXT_ARCHIVING_FLAG:8},E={ContextUser:1,ContextMachine:2,ContextAdministratorForceMachine:3},f={XCN_CERT_NO_KEY_USAGE:0,XCN_CERT_DIGITAL_SIGNATURE_KEY_USAGE:128,XCN_CERT_NON_REPUDIATION_KEY_USAGE:64,XCN_CERT_KEY_ENCIPHERMENT_KEY_USAGE:32,XCN_CERT_DATA_ENCIPHERMENT_KEY_USAGE:16,XCN_CERT_KEY_AGREEMENT_KEY_USAGE:8,XCN_CERT_KEY_CERT_SIGN_KEY_USAGE:4,XCN_CERT_OFFLINE_CRL_SIGN_KEY_USAGE:2,XCN_CERT_CRL_SIGN_KEY_USAGE:2,XCN_CERT_ENCIPHER_ONLY_KEY_USAGE:1,XCN_CERT_DECIPHER_ONLY_KEY_USAGE:32768},C={XCN_CERT_NAME_STR_NONE:0,XCN_CERT_SIMPLE_NAME_STR:1,XCN_CERT_OID_NAME_STR:2,XCN_CERT_X500_NAME_STR:3,XCN_CERT_XML_NAME_STR:4,XCN_CERT_NAME_STR_SEMICOLON_FLAG:1073741824,XCN_CERT_NAME_STR_NO_PLUS_FLAG:536870912,XCN_CERT_NAME_STR_NO_QUOTING_FLAG:268435456,XCN_CERT_NAME_STR_CRLF_FLAG:134217728,XCN_CERT_NAME_STR_COMMA_FLAG:67108864,XCN_CERT_NAME_STR_REVERSE_FLAG:33554432,XCN_CERT_NAME_STR_FORWARD_FLAG:16777216,XCN_CERT_NAME_STR_DISABLE_IE4_UTF8_FLAG:65536,XCN_CERT_NAME_STR_ENABLE_T61_UNICODE_FLAG:131072,XCN_CERT_NAME_STR_ENABLE_UTF8_UNICODE_FLAG:262144,XCN_CERT_NAME_STR_FORCE_UTF8_DIR_STR_FLAG:524288,XCN_CERT_NAME_STR_DISABLE_UTF8_DIR_STR_FLAG:1048576},p={XCN_CRYPT_STRING_BASE64HEADER:0,XCN_CRYPT_STRING_BASE64:1,XCN_CRYPT_STRING_BINARY:2,XCN_CRYPT_STRING_BASE64REQUESTHEADER:3,XCN_CRYPT_STRING_HEX:4,XCN_CRYPT_STRING_HEXASCII:5,XCN_CRYPT_STRING_BASE64_ANY:6,XCN_CRYPT_STRING_ANY:7,XCN_CRYPT_STRING_HEX_ANY:8,XCN_CRYPT_STRING_BASE64X509CRLHEADER:9,XCN_CRYPT_STRING_HEXADDR:10,XCN_CRYPT_STRING_HEXASCIIADDR:11,XCN_CRYPT_STRING_HEXRAW:12,XCN_CRYPT_STRING_NOCRLF:1073741824,XCN_CRYPT_STRING_NOCR:2147483648},d={AllowNone:0,AllowNoOutstandingRequest:1,AllowUntrustedCertificate:2,AllowUntrustedRoot:4},I={GOST_R_34_10_2001:75,GOST_R_34_10_2012:80},A={"0x800B010A":"Не удается построить цепочку сертификатов для доверенного корневого центра","0x80090020":"Внутренняя ошибка 0x80090020. Если используется внешний токен, убедитесь, что ввели корректный PIN-код","0x8007065B":"Истекла лицензия на КриптоПро CSP"};var g=function(){var e,t=!1;function r(e){if(e.message)for(var t in A)if(A.hasOwnProperty(t)&&e.message.indexOf(t)+1){e.message=A[t];break}return e.message||e}function o(e){var t=new i;return e.match(/([а-яёА-ЯЁa-zA-Z0-9\.]+)=(?:("[^"]+?")|(.+?))(?:,|$)/g).map(function(e){return e.replace(/,$/,"")}).forEach(function(e){var n=e.match(/([^=]+)=(.*)/);if(3===n.length){var r=n[1].trim().replace(/^OID\./,""),i=n[2].trim().replace(/^"(.*)"$/,"$1");t[r]=i}}),t}function c(e){var t=e["СНИЛС"]||e.SNILS,n=e["ИНН"]||e.INN;return e.CN+(n?"; ИНН "+n:"")+(t?"; СНИЛС "+t:"")}function u(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}this.init=function(){return window.cadesplugin_skip_extension_install=!0,window.allow_firefox_cadesplugin_async=!0,n(104),e=!!cadesplugin.CreateObjectAsync,new Promise(function(e,t){if(!window.cadesplugin)throw new Error("КриптоПро ЭЦП Browser plug-in не обнаружен");e()}).then(function(){return e?cadesplugin.then(function(){return cadesplugin.CreateObjectAsync("CAdESCOM.About")}).then(function(e){return e.Version}).then(function(e){return{version:e}}).catch(function(e){var t=r(e);throw new Error(t)}):new Promise(function(e){try{var t=cadesplugin.CreateObject("CAdESCOM.About");if(!t||!t.Version)throw new Error("КриптоПро ЭЦП Browser plug-in не загружен");e({version:t.Version})}catch(e){var n=r(e);throw new Error(n)}})})},this.bind=function(e){return t=!0,Promise.resolve(t)},this.unbind=function(){return t=!1,Promise.resolve(t)},this.generateCSR=function(t,n,i,o){var a,c,_,d,A,g,h,O,T,S,N,R,v;return i&&i.length||(i=["1.3.6.1.5.5.7.3.2","1.3.6.1.5.5.7.3.4"]),o||(o=I.GOST_R_34_10_2012),e?cadesplugin.then(function(){return Promise.all([cadesplugin.CreateObjectAsync("X509Enrollment.CX509Enrollment"),cadesplugin.CreateObjectAsync("X509Enrollment.CX509CertificateRequestPkcs10"),cadesplugin.CreateObjectAsync("X509Enrollment.CX509PrivateKey"),cadesplugin.CreateObjectAsync("X509Enrollment.CX509ExtensionKeyUsage"),cadesplugin.CreateObjectAsync("X509Enrollment.CX509ExtensionEnhancedKeyUsage"),cadesplugin.CreateObjectAsync("X509Enrollment.CObjectIds"),cadesplugin.CreateObjectAsync("X509Enrollment.CX500DistinguishedName"),cadesplugin.CreateObjectAsync("X509Enrollment.CX509Extensions"),cadesplugin.CreateObjectAsync("X509Enrollment.CCspInformations"),cadesplugin.CreateObjectAsync("X509Enrollment.CX509Extension")])}).then(function(e){return a=e[0],c=e[1],_=e[2],A=e[3],g=e[4],h=e[5],S=e[6],d=e[7],N=e[8],v=e[9],N.AddAvailableCsps()}).then(function(){return N.Count}).then(function(e){if(!e)throw new Error("No CSP informations!");for(var t=[],n=0;n<e;n++)t.push(N.ItemByIndex(n));return Promise.all(t)}).then(function(e){var t=[];for(var n in e){var r=e[n];t.push(r.LegacyCsp),t.push(r.Type),t.push(r.Name)}return Promise.all(t)}).then(function(e){for(var t,r,i=0;i<e.length;i+=3){var a=e[i],c=e[i+1],u=e[i+2];if(a&&c==o){t=c,r=R=u;break}}if(!r||!t)throw new Error("No suitable CSP!");var E=[_.propset_KeySpec(s.XCN_AT_SIGNATURE),_.propset_Existing(!1),_.propset_ExportPolicy(l.XCN_NCRYPT_ALLOW_EXPORT_FLAG),_.propset_ProviderType(t),_.propset_ProviderName(r)];return n&&E.push(_.propset_Pin(n)),Promise.all(E)}).then(function(){return c.InitializeFromPrivateKey(E.ContextUser,_,"")}).then(function(){return A.InitializeEncode(f.XCN_CERT_DIGITAL_SIGNATURE_KEY_USAGE|f.XCN_CERT_KEY_ENCIPHERMENT_KEY_USAGE|f.XCN_CERT_NON_REPUDIATION_KEY_USAGE|f.XCN_CERT_DATA_ENCIPHERMENT_KEY_USAGE)}).then(function(){for(var e=[],t=0;t<i.length;t++)e.push(cadesplugin.CreateObjectAsync("X509Enrollment.CObjectId"));return Promise.all(e)}).then(function(e){O=e;for(var t=0;t<i.length;t++)O[t].InitializeFromValue(i[t]);return Promise.all([])}).then(function(){for(var e=0;e<i.length;e++)h.Add(O[e]);return Promise.all([])}).then(function(){return cadesplugin.CreateObjectAsync("X509Enrollment.CObjectId")}).then(function(e){return(T=e).InitializeFromValue("1.2.643.100.111")}).then(function(){var e=u(R.slice(0,127));e.unshift(12,e.length);var t=btoa(String.fromCharCode.apply(null,new Uint8Array(e)));return v.Initialize(T,p.XCN_CRYPT_STRING_BASE64,t)}).then(function(){return g.InitializeEncode(h)}).then(function(){return c.X509Extensions}).then(function(e){return d=e,Promise.all([d.Add(A),d.Add(g),d.Add(v)])}).then(function(){var e=t.toString();return S.Encode(e,C.XCN_CERT_X500_NAME_STR)}).then(function(){return c.propset_Subject(S)}).then(function(){return a.InitializeFromRequest(c)}).then(function(){return a.CreateRequest(p.XCN_CRYPT_STRING_BASE64)}).then(function(e){return{csr:e}}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)}):new Promise(function(e){try{var n,a,c=cadesplugin.CreateObject("X509Enrollment.CCspInformations"),_=cadesplugin.CreateObject("X509Enrollment.CX509Enrollment"),d=cadesplugin.CreateObject("X509Enrollment.CX509CertificateRequestPkcs10"),I=cadesplugin.CreateObject("X509Enrollment.CX509PrivateKey"),A=cadesplugin.CreateObject("X509Enrollment.CX509ExtensionKeyUsage"),g=cadesplugin.CreateObject("X509Enrollment.CX509ExtensionEnhancedKeyUsage"),h=cadesplugin.CreateObject("X509Enrollment.CObjectIds"),O=cadesplugin.CreateObject("X509Enrollment.CX500DistinguishedName");cadesplugin.CreateObject("X509Enrollment.CX509Extensions"),c.AddAvailableCsps();for(var T=0;T<c.Count;T++){var S=c.ItemByIndex(T);if(S.LegacyCsp&&S.Type==o){n=S.Type,a=S.Name;break}}if(!a||!n)throw new Error("No suitable CSP!");I.KeySpec=s.XCN_AT_SIGNATURE,I.Existing=!1,I.ExportPolicy=l.XCN_NCRYPT_ALLOW_EXPORT_FLAG,I.ProviderName=a,I.ProviderType=n,d.InitializeFromPrivateKey(E.ContextUser,I,""),A.InitializeEncode(f.XCN_CERT_DIGITAL_SIGNATURE_KEY_USAGE|f.XCN_CERT_KEY_ENCIPHERMENT_KEY_USAGE|f.XCN_CERT_NON_REPUDIATION_KEY_USAGE|f.XCN_CERT_DATA_ENCIPHERMENT_KEY_USAGE);var N=[];for(T=0;T<i.length;T++)N.push(cadesplugin.CreateObject("X509Enrollment.CObjectId")),N[T].InitializeFromValue(i[T]),h.Add(N[T]);g.InitializeEncode(h),d.X509Extensions.Add(A),d.X509Extensions.Add(g);var R=cadesplugin.CreateObject("X509Enrollment.CObjectId");R.InitializeFromValue("1.2.643.100.111");var v=a.slice(0,127),m=u(v);m.unshift(12,v.length);var P=btoa(String.fromCharCode.apply(null,new Uint8Array(m))),y=cadesplugin.CreateObject("X509Enrollment.CX509Extension");y.Initialize(R,p.XCN_CRYPT_STRING_BASE64,P),d.X509Extensions.Add(y);var D=t.toString();O.Encode(D,C.XCN_CERT_X500_NAME_STR),d.Subject=O,_.InitializeFromRequest(d),e({csr:_.CreateRequest(p.XCN_CRYPT_STRING_BASE64)})}catch(e){console.log(e);var L=r(e);throw new Error(L)}})},this.writeCertificate=function(t){if(e){var n,i=[];return this.listCertificates().then(function(e){for(var t in e)i.push(e[t].shift());return cadesplugin.CreateObjectAsync("X509Enrollment.CX509Enrollment")}).then(function(e){return(n=e).Initialize(E.ContextUser)}).then(function(){return n.InstallResponse(d.AllowNone,t,p.XCN_CRYPT_STRING_BASE64,"")}).then(this.listCertificates).then(function(e){for(var t in e){var n=e[t].shift();if(i.indexOf(n)<0)return n}throw new Error("Не удалось найти установленный сертификат по отпечатку")}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)})}return new Promise(function(e){try{var n=[];(a=cadesplugin.CreateObject("CAPICOM.Store")).Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);for(var i=a.Certificates,o=1;o<=i.Count;o++)n.push(i.Item(o).Thumbprint);a.Close();var a,c=cadesplugin.CreateObject("X509Enrollment.CX509Enrollment");c.Initialize(E.ContextUser),c.InstallResponse(d.AllowNone,t,p.XCN_CRYPT_STRING_BASE64,""),(a=cadesplugin.CreateObject("CAPICOM.Store")).Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED),i=a.Certificates;var u=!1;for(o=1;o<=i.Count;o++){var _=i.Item(o).Thumbprint;n.indexOf(_)<0&&(u=!0)}if(a.Close(),!u)throw new Error("Не удалось найти установленный сертификат по отпечатку");e(_)}catch(e){console.log(e);var s=r(e);throw new Error(s)}})},this.certificateInfo=function(t){var n=function(){return"Название:              "+this.Name+"\nИздатель:              "+this.IssuerName+"\nСубъект:               "+this.SubjectName+"\nВерсия:                "+this.Version+"\nСерийный №:            "+this.SerialNumber+"\nОтпечаток SHA1:        "+this.Thumbprint+"\nНе действителен до:    "+this.ValidFromDate+"\nНе действителен после: "+this.ValidToDate+"\nПриватный ключ:        "+(this.HasPrivateKey?"Есть":"Нет")+"\nВалидный:              "+(this.IsValid?"Да":"Нет")};if(e){var i,c,u,_={};return cadesplugin.then(function(){return cadesplugin.CreateObjectAsync("CAPICOM.Store")}).then(function(e){return(i=e).Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED)}).then(function(){return i.Certificates}).then(function(e){return e.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,t)}).then(function(e){return(c=e).Count}).then(function(e){if(1!=e)throw new Error("Не обнаружено сертификатов c указанным SHA1");return c.Item(1)}).then(function(e){return u=e,i.Close()}).then(function(){var e=[u.HasPrivateKey(),u.IsValid(),u.IssuerName,u.SerialNumber,u.SubjectName,u.Thumbprint,u.ValidFromDate,u.ValidToDate,u.Version];return Promise.all(e)}).then(function(e){return _={HasPrivateKey:e[0],IsValid:void 0,IssuerName:e[2],SerialNumber:e[3],SubjectName:e[4],Subject:void 0,Name:void 0,Thumbprint:e[5],ValidFromDate:new Date(e[6]),ValidToDate:new Date(e[7]),Version:e[8]},e[1].Result}).then(function(e){var t=o(_.SubjectName);return t=a(t),_.Subject=t,_.Name=t.CN,_.IsValid=e,_.toString=n,_}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)})}return new Promise(function(e){try{var i=cadesplugin.CreateObject("CAPICOM.Store");i.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);var c=i.Certificates.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,t);if(1!=c.Count)throw new Error("Не обнаружено сертификатов c указанным SHA1");var u=c.Item(1);i.Close();var _=u.IsValid(),s=o(u.SubjectName);s=a(s);var l={HasPrivateKey:u.HasPrivateKey(),IsValid:_.Result,IssuerName:u.IssuerName,SerialNumber:u.SerialNumber,SubjectName:u.SubjectName,Subject:s,Name:s.CN,Thumbprint:u.Thumbprint,ValidFromDate:new Date(u.ValidFromDate),ValidToDate:new Date(u.ValidToDate),Version:u.Version};l.toString=n,e(l)}catch(e){console.log(e);var E=r(e);throw new Error(E)}})},this.listCertificates=function(){var t,n,i;return e?cadesplugin.then(function(){return cadesplugin.CreateObjectAsync("CAPICOM.Store")}).then(function(e){return(t=e).Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED)}).then(function(){return t.Certificates}).then(function(e){return n=e,e.Count}).then(function(e){if(e<1)throw new Error("Не обнаружено сертификатов");for(var t=[],r=1;r<=e;r++)t.push(n.Item(r));return Promise.all(t)}).then(function(e){var t=[];for(var n in e)t.push(e[n].SubjectName,e[n].Thumbprint);return Promise.all(t)}).then(function(e){for(var n=[],r=0;r<e.length;r+=2){var a=o(e[r]);n.push({id:e[r+1],name:c(a)})}return i=n,t.Close()}).then(function(){return i}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)}):new Promise(function(e){try{var t=cadesplugin.CreateObject("CAPICOM.Store");t.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);for(var n=t.Certificates,i=[],a=1;a<=n.Count;a++){var u=n.Item(a),_=o(u.SubjectName);i.push({id:u.Thumbprint,name:c(_)})}t.Close(),e(i)}catch(e){console.log(e);var s=r(e);throw new Error(s)}})},this.readCertificate=function(t){var n,i,o;return e?cadesplugin.then(function(){return cadesplugin.CreateObjectAsync("CAPICOM.Store")}).then(function(e){return(n=e).Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED)}).then(function(){return n.Certificates}).then(function(e){return e.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,t)}).then(function(e){return(i=e).Count}).then(function(e){if(1!=e)throw new Error("Не обнаружено сертификатов c указанным SHA1");return i.Item(1)}).then(function(e){return o=e,n.Close()}).then(function(){return o.Export(cadesplugin.CADESCOM_ENCODE_BASE64)}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)}):new Promise(function(e){try{var n=cadesplugin.CreateObject("CAPICOM.Store");n.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);var i=n.Certificates.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,t);if(1!=i.Count)throw new Error("Не обнаружено сертификатов c указанным SHA1");var o=i.Item(1);n.Close(),e(o.Export(cadesplugin.CADESCOM_ENCODE_BASE64))}catch(e){console.log(e);var a=r(e);throw new Error(a)}})},this.signData=function(n,i,o){var a,c,u,_,s;return e?cadesplugin.then(function(){return Promise.all([cadesplugin.CreateObjectAsync("CAPICOM.Store"),cadesplugin.CreateObjectAsync("CAdESCOM.CPSigner"),cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData")])}).then(function(e){return a=e[0],_=e[1],s=e[2],a.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED)}).then(function(){return a.Certificates}).then(function(e){return e.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,i)}).then(function(e){return(c=e).Count}).then(function(e){if(1!=e)throw new Error("Не обнаружено сертификатов c указанным SHA1");return c.Item(1)}).then(function(e){return u=e,a.Close()}).then(function(){return u.PrivateKey}).then(function(e){return e.propset_CachePin(t)}).then(function(){var e=[_.propset_Certificate(u),_.propset_Options(cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY)];return o&&e.push(_.propset_KeyPin(o)),Promise.all(e)}).then(function(){return s.propset_ContentEncoding(cadesplugin.CADESCOM_BASE64_TO_BINARY)}).then(function(){return s.propset_Content(n)}).then(function(){return s.SignCades(_,cadesplugin.CADESCOM_CADES_BES,!0)}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)}):new Promise(function(e){try{var a=cadesplugin.CreateObject("CAPICOM.Store");a.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);var c=a.Certificates.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,i);if(1!=c.Count)throw new Error("Не обнаружено сертификатов c указанным SHA1");var u=c.Item(1);a.Close(),u.PrivateKey&&void 0!==u.PrivateKey.CachePin&&(u.PrivateKey.CachePin=t);var _=cadesplugin.CreateObject("CAdESCOM.CPSigner");_.Certificate=u,_.Options=cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY,o&&(_.KeyPin=o);var s=cadesplugin.CreateObject("CAdESCOM.CadesSignedData");s.ContentEncoding=cadesplugin.CADESCOM_BASE64_TO_BINARY,s.Content=n,e(s.SignCades(_,cadesplugin.CADESCOM_CADES_BES,!0))}catch(e){console.log(e);var l=r(e);throw new Error(l)}})},this.signData2=function(t,n,i,o,a){var c,u,_,s,l;return e?cadesplugin.then(function(){return Promise.all([cadesplugin.CreateObjectAsync("CAPICOM.Store"),cadesplugin.CreateObjectAsync("CAdESCOM.CPSigner"),cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData")])}).then(function(e){if(c=e[0],s=e[1],l=e[2],!c)throw new Error("Не обнаружено хранилище");return c.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED)}).then(function(){return c.Certificates}).then(function(e){return Promise.all([e.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,n),e.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,o)])}).then(function(e){return Promise.all([e[0].Count,e[0].Item(1),e[1].Count,e[1].Item(1)])}).then(function(e){return 1!=e[0]&&new Error("Не найден сертификат по SHA1"),1!=e[2]&&new Error("Не найден сертификат-2 по SHA1"),u=e[1],_=e[3],c.Close()}).then(function(){return l.propset_ContentEncoding(cadesplugin.CADESCOM_BASE64_TO_BINARY)}).then(function(){return l.propset_Content(t)}).then(function(){var e=[s.propset_Certificate(u),s.propset_Options(cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY),s.propset_KeyPin(i||"")];return Promise.all(e)}).then(function(){return l.SignCades(s,cadesplugin.CADESCOM_CADES_BES,!0)}).then(function(e){var t=[s.propset_Certificate(_),s.propset_Options(cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY),s.propset_KeyPin(a||"")];return Promise.all(t)}).then(function(){return l.CoSignCades(s,cadesplugin.CADESCOM_CADES_BES)}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)}):new Promise(function(e){try{var c=cadesplugin.CreateObject("CAPICOM.Store");c.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);var u=c.Certificates.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,n);if(1!=u.Count)throw new Error("Не найден сертификат по SHA1");var _=u.Item(1),s=c.Certificates.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,o);if(1!=s.Count)throw new Error("Не найден сертификат-2 по SHA1");var l=s.Item(1);c.Close();var E=cadesplugin.CreateObject("CAdESCOM.CadesSignedData");E.ContentEncoding=cadesplugin.CADESCOM_BASE64_TO_BINARY,E.Content=t;var f=cadesplugin.CreateObject("CAdESCOM.CPSigner");f.Certificate=_,f.Options=cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY,f.KeyPin=i||"",E.SignCades(f,cadesplugin.CADESCOM_CADES_BES,!0),f.Certificate=l,f.Options=cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY,f.KeyPin=a||"",e(E.CoSignCades(f,cadesplugin.CADESCOM_CADES_BES))}catch(e){console.log(e);var C=r(e);throw new Error(C)}})},this.addSign=function(t,n,i,o){var a,c,u,_;return e?cadesplugin.then(function(){return Promise.all([cadesplugin.CreateObjectAsync("CAPICOM.Store"),cadesplugin.CreateObjectAsync("CAdESCOM.CPSigner"),cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData")])}).then(function(e){if(a=e[0],u=e[1],_=e[2],!a)throw new Error("Не обнаружено хранилище");return a.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED)}).then(function(){return a.Certificates}).then(function(e){return e.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,i)}).then(function(e){return Promise.all([e.Count,e.Item(1)])}).then(function(e){return 1!=e[0]&&new Error("Не найден сертификат по SHA1"),c=e[1],a.Close()}).then(function(){return _.propset_ContentEncoding(cadesplugin.CADESCOM_BASE64_TO_BINARY)}).then(function(){return _.propset_Content(t)}).then(function(){return _.VerifyCades(n,cadesplugin.CADESCOM_CADES_BES,!0).catch(function(e){console.log("Existing sign not verified: %o",e)})}).then(function(e){var t=[u.propset_Certificate(c),u.propset_Options(cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY),u.propset_KeyPin(o||"")];return Promise.all(t)}).then(function(){return _.CoSignCades(u,cadesplugin.CADESCOM_CADES_BES)}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)}):new Promise(function(e){try{var a=cadesplugin.CreateObject("CAPICOM.Store");a.Open(cadesplugin.CAPICOM_CURRENT_USER_STORE,cadesplugin.CAPICOM_MY_STORE,cadesplugin.CAPICOM_STORE_OPEN_MAXIMUM_ALLOWED);var c=a.Certificates.Find(cadesplugin.CAPICOM_CERTIFICATE_FIND_SHA1_HASH,i);if(1!=c.Count)throw new Error("Не найден сертификат по SHA1");var u=c.Item(1);a.Close();var _=cadesplugin.CreateObject("CAdESCOM.CadesSignedData");_.ContentEncoding=cadesplugin.CADESCOM_BASE64_TO_BINARY,_.Content=t;try{_.VerifyCades(n,cadesplugin.CADESCOM_CADES_BES,!0)}catch(e){console.log("Existing sign not verified: %o",e)}var s=cadesplugin.CreateObject("CAdESCOM.CPSigner");s.Certificate=u,s.Options=cadesplugin.CAPICOM_CERTIFICATE_INCLUDE_END_ENTITY_ONLY,s.KeyPin=o||"",e(_.CoSignCades(s,cadesplugin.CADESCOM_CADES_BES))}catch(e){console.log(e);var l=r(e);throw new Error(l)}})},this.verifySign=function(t,n){var i;return e?cadesplugin.then(function(){return cadesplugin.CreateObjectAsync("CAdESCOM.CadesSignedData")}).then(function(e){return(i=e).propset_ContentEncoding(cadesplugin.CADESCOM_BASE64_TO_BINARY)}).then(function(){return i.propset_Content(t)}).then(function(){return i.VerifyCades(n,cadesplugin.CADESCOM_CADES_BES,!0)}).then(function(){return!0}).catch(function(e){console.log(arguments);var t=r(e);throw new Error(t)}):new Promise(function(e){try{var i=cadesplugin.CreateObject("CAdESCOM.CadesSignedData");i.ContentEncoding=cadesplugin.CADESCOM_BASE64_TO_BINARY,i.Content=t,i.VerifyCades(n,cadesplugin.CADESCOM_CADES_BES,!0),e(!0)}catch(e){console.log(e);var o=r(e);throw new Error(o)}})}},h=n(29),O=n.n(h),T={ALREADY_LOGGED_IN:"Пользователь уже авторизован",ASN1_ERROR:"Ошибка разбора структуры ASN1",BAD_PARAMS:"Неправильные параметры",BASE64_DECODE_FAILED:"Ошибка декодирования из base64",CA_CERTIFICATES_NOT_FOUND:"Корневые сертификаты отсутствуют",CANNOT_SAVE_PIN_IN_CACHE:"Невозможно сохранить PIN-код",CANT_HARDWARE_VERIFY_CMS:"Проверка множественной подписи с вычислением хеша на устройстве не поддерживается",CEK_NOT_AUTHENTIC:"Контейнер в формате CMS поврежден или переданный ключ не является ключом получателя",CERTIFICATE_CATEGORY_BAD:"Некорректная категория сертификата",CERTIFICATE_EXISTS:"Сертификат с таким телом уже существует на устройстве",CERTIFICATE_HASH_NOT_UNIQUE:"Идентификатор сертификата не уникален",CERTIFICATE_NOT_FOUND:"Сертификат не найден на устройстве",CERTIFICATE_VERIFICATION_ERROR:"Ошибка проверки сертификата",DATA_INVALID:"Неверные данные",DEVICE_ERROR:"Ошибка устройства.",DEVICE_NOT_FOUND:"Устройство не найдено",FUNCTION_FAILED:"Невозможно выполнить операцию",FUNCTION_REJECTED:"Операция отклонена пользователем",KEY_FUNCTION_NOT_PERMITTED:"Операция запрещена для данного типа ключа",KEY_ID_NOT_UNIQUE:"Идентификатор ключевой пары не уникален",KEY_LABEL_NOT_UNIQUE:"Метка ключевой пары не уникальна",KEY_NOT_FOUND:"Не найдена соответствующая ключевая пара.",LICENCE_READ_ONLY:"Лицензия доступна только для чтения",NOT_ENOUGH_MEMORY:"Недостаточно памяти",PEM_ERROR:"Ошибка декодирования PEM",PIN_CHANGED:"PIN-код был изменен извне",PIN_INCORRECT:"Введен неправильный PIN-код",PIN_INVALID:"PIN-код содержит недопустимые символы",PIN_LENGTH_INVALID:"Введен слишком короткий PIN-код",PIN_LOCKED:"PIN-код заблокирован",PKCS11_LOAD_FAILED:"Не удалось загрузить модуль PKCS#11",SESSION_INVALID:"Текущая сессия устарела",TOKEN_INVALID:"Ошибка чтения/записи устройства.",UNSUPPORTED_BY_TOKEN:"Операция не поддерживается токеном",USER_NOT_LOGGED_IN:"Пользователь не авторизован",USER_PIN_NOT_INITIALIZED:"PIN-код пользователя не инициализирован",WRONG_KEY_TYPE:"Неправильный тип ключа",X509_AKID_ISSUER_SERIAL_MISMATCH:"Несовпадение серийного номера субьекта и доверенного центра",X509_AKID_SKID_MISMATCH:"Несовпадение идентификатора ключа у субьекта и доверенного центра",X509_APPLICATION_VERIFICATION:"Ошибка проверки приложения",X509_CERT_CHAIN_TOO_LONG:"Слишком длинная цепочка сертификатов",X509_CERT_HAS_EXPIRED:"Срок действия сертификата истек",X509_CERT_NOT_YET_VALID:"Срок действия сертификата еще не начался",X509_CERT_REJECTED:"Сертифкат отклонен",X509_CERT_REVOKED:"Сертификат отозван",X509_CERT_SIGNATURE_FAILURE:"Неверная подпись сертификата",X509_CERT_UNTRUSTED:"Недоверенный сертификат",X509_CRL_HAS_EXPIRED:"Срок действия CRL истек",X509_CRL_NOT_YET_VALID:"Срок действия CRL еще не начался",X509_CRL_PATH_VALIDATION_ERROR:"Неправильный путь CRL",X509_CRL_SIGNATURE_FAILURE:"Неверная подпись CRL",X509_DEPTH_ZERO_SELF_SIGNED_CERT:"Недоверенный самоподписанный сертификат",X509_DIFFERENT_CRL_SCOPE:"Другая область CRL",X509_ERROR_IN_CERT_NOT_AFTER_FIELD:'Некорректные данные в поле "notAfter" у сертификата',X509_ERROR_IN_CERT_NOT_BEFORE_FIELD:'Некорректные данные в поле "notBefore" у сертификата',X509_ERROR_IN_CRL_LAST_UPDATE_FIELD:'Некорректные данные в поле "lastUpdate" у CRL',X509_ERROR_IN_CRL_NEXT_UPDATE_FIELD:'Некорректные данные в поле "nextUpdate" у CRL',X509_EXCLUDED_VIOLATION:"Неправильная структура сертфиката",X509_INVALID_CA:"Неверный корневой сертификат",X509_INVALID_EXTENSION:"Неверное или некорректное расширение сертификата",X509_INVALID_NON_CA:"Неверный некорневой сертфикат, помеченный как корневой",X509_INVALID_POLICY_EXTENSION:"Неверное или некорректное расширение политик сертификата",X509_INVALID_PURPOSE:"Неподдерживаемое назначение сертификата",X509_KEYUSAGE_NO_CERTSIGN:"Ключ не может быть использован для подписи сертификатов",X509_KEYUSAGE_NO_CRL_SIGN:"Ключ не может быть использован для подписи CRL",X509_KEYUSAGE_NO_DIGITAL_SIGNATURE:"Ключ не может быть использован для цифровой подписи",X509_NO_EXPLICIT_POLICY:"Явные политики отсутствуют",X509_OUT_OF_MEM:"Нехватает памяти",X509_PATH_LENGTH_EXCEEDED:"Превышена длина пути",X509_PERMITTED_VIOLATION:"Неправильная структура сертифката",X509_PROXY_CERTIFICATES_NOT_ALLOWED:"Проксирующие сертификаты недопустимы",X509_PROXY_PATH_LENGTH_EXCEEDED:"Превышина длина пути прокси",X509_SELF_SIGNED_CERT_IN_CHAIN:"В цепочке обнаружен недоверенный самоподписанный сертификат",X509_SUBJECT_ISSUER_MISMATCH:"Несовпадения субьекта и эмитента",X509_SUBTREE_MINMAX:"Неправильная структура сертифката",X509_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY:"Невозможно раскодировать открытый ключ эмитента",X509_UNABLE_TO_DECRYPT_CERT_SIGNATURE:"Невозможно расшифровать подпись сертификата",X509_UNABLE_TO_DECRYPT_CRL_SIGNATURE:"Невозможно расшифровать подпись CRL",X509_UNABLE_TO_GET_CRL:"Невозможно получить CRL",X509_UNABLE_TO_GET_CRL_ISSUER:"Невозможно получить CRL подписанта",X509_UNABLE_TO_GET_ISSUER_CERT:"Невозможно получить сертификат подписанта",X509_UNABLE_TO_GET_ISSUER_CERT_LOCALLY:"Невозможно получить локальный сертификат подписанта",X509_UNABLE_TO_VERIFY_LEAF_SIGNATURE:"Невозможно проверить первый сертификат",X509_UNHANDLED_CRITICAL_CRL_EXTENSION:"Неподдерживаемое расширение CRL",X509_UNHANDLED_CRITICAL_EXTENSION:"Неподдерживаемое расширение",X509_UNNESTED_RESOURCE:"RFC 3779 неправильное наследование ресурсов",X509_UNSUPPORTED_CONSTRAINT_SYNTAX:"Неправильная структура сертифката",X509_UNSUPPORTED_CONSTRAINT_TYPE:"Неправильная структура сертфиката",X509_UNSUPPORTED_EXTENSION_FEATURE:"Неподдерживаемое расширение возможностей",X509_UNSUPPORTED_NAME_SYNTAX:"Неправильная структура сертфиката"};var S=function(){var e,t;function n(t){var n=t.message&&t.message.match(/^[0-9]+$/)&&t.message||t,r="";if(e)for(var i in e.errorCodes)if(e.errorCodes[i]==n){r=i;break}return r&&T[r]||r||t.message||t}function r(e,t){var n=new i;for(var r in e.subject){var o=e.subject[r].rdn,a=e.subject[r].value;n[o]=a}return n.toString=function(){var e=this.commonName||this.CN||this["2.5.4.3"],n=this["СНИЛС"]||this.SNILS||this["1.2.643.100.3"],r=this["ИНН"]||this.INN||this["1.2.643.3.131.1.1"];return e+(r?"; ИНН "+r:"")+(n?"; СНИЛС "+n:"")+(t?" ("+t+")":"")},n.toString()}function o(e){return e.replace(/^-+(BEGIN|END)[^-]+-+$/gm,"").trim()}this.init=function(){return O.a.ready.then(function(e){return window.chrome?O.a.isExtensionInstalled():Promise.resolve(!0)}).then(function(e){if(e)return O.a.isPluginInstalled();throw new Error("Rutoken Extension wasn't found")}).then(function(e){if(e)return O.a.loadPlugin();throw new Error("Rutoken Plugin wasn't found")}).then(function(t){return(e=t).enumerateDevices()}).then(function(n){var r=n.length;if(1===r)t=n.shift();else{if(0===r)throw new Error("Не обнаружено подключенных устройств");if(r>1)throw new Error("Подключено "+r+" устройств")}return Promise.all([e.getDeviceInfo(t,e.TOKEN_INFO_READER),e.getDeviceInfo(t,e.TOKEN_INFO_LABEL),e.getDeviceInfo(t,e.TOKEN_INFO_SERIAL),e.getDeviceModel(t),e.getDeviceType(t)])}).then(function(t){return{version:e.version,serial:t[2],reader:t[0],label:t[1].indexOf("Rutoken ECP <no label>")+1?"":t[1],type:t[4],model:t[3]}}).then(null,function(e){var t=n(e);throw new Error(t)})},this.bind=function(r){return new Promise(function(i,o){e.getDeviceInfo(t,e.TOKEN_INFO_IS_LOGGED_IN).then(function(e){if(e)return i("Пользователь уже авторизован"),!1;if(!r&&!(r=prompt("PIN-код доступа к устройству")))throw new Error("Авторизация на устройстве отменена пользователем");return!0}).then(function(n){if(n)return e.login(t,r).then(function(e){i(!0)});i(!0)}).then(null,function(e){var t=n(e);o(t)})})},this.unbind=function(){return new Promise(function(r,i){e.getDeviceInfo(t,e.TOKEN_INFO_IS_LOGGED_IN).then(function(e){return!!e||(r("Пользователь не авторизован"),!1)}).then(function(n){return!n||e.logout(t).then(function(e){r(!0)})}).then(null,function(e){var t=n(e);i(t)})})},this.clean=function(){var r=0;return e.enumerateCertificates(t,e.CERT_CATEGORY_USER).then(function(n){var i=[];for(var o in n){var a=n[o];i.push(e.deleteCertificate(t,a))}return r+=i.length,Promise.all(i)}).then(function(){return e.enumerateKeys(t,"")}).then(function(n){var i=[];for(var o in n){var a=n[o];i.push(e.deleteKeyPair(t,a))}return r+=i.length,Promise.all(i)}).then(function(){return r}).then(null,function(e){var t=n(e);throw new Error(t)})},this.generateCSR=function(r,i,a,c){var u="";i||(i=""),a&&a.length||(a=["clientAuth","emailProtection"]);var _=c&&e[c]||e.PUBLIC_KEY_ALGORITHM_GOST3410_2012_256,s="XA",l=e.HASH_TYPE_GOST3411_94;_===e.PUBLIC_KEY_ALGORITHM_GOST3410_2012_512?(s="A",l=e.HASH_TYPE_GOST3411_12_512):_===e.PUBLIC_KEY_ALGORITHM_GOST3410_2012_256&&(l=e.HASH_TYPE_GOST3411_12_256);var E={publicKeyAlgorithm:_,paramset:s};return e.generateKeyPair(t,void 0,i,E).then(function(n){u=n;var i=[];for(var o in r)r.hasOwnProperty(o)&&i.push({rdn:o,value:r[o]});var c={keyUsage:["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment"],extKeyUsage:a},_={subjectSignTool:'СКЗИ "РУТОКЕН ЭЦП"',hashAlgorithm:l};return e.createPkcs10(t,u,i,c,_)}).then(function(e){return{csr:o(e),keyPairId:u}}).then(null,function(r){u&&e.deleteKeyPair(t,u);var i=n(r);throw new Error(i)})},this.writeCertificate=function(r){var i=e.CERT_CATEGORY_USER;return e.importCertificate(t,r,i).then(null,function(e){var t=n(e);throw new Error(t)})},this.certificateInfo=function(r){var o=!1,c="";return new Promise(function(i){e.getKeyByCertificate(t,r).then(function(e){i(!!e)}).then(null,function(e){var t=n(e);console.log("getKeyByCertificate",r,t),i(!1)})}).then(function(n){return o=n,e.getCertificateInfo(t,r,e.CERT_INFO_SERIAL_NUMBER)}).then(function(n){return c=n,e.parseCertificate(t,r)}).then(function(e){var t=e.text.match(/Version: (\d+)/),n=t.length>1?t[1]:void 0,u=new i;for(var _ in e.subject){var s=e.subject[_].rdn,l=e.subject[_].value;u[s]=l}u=a(u);var E=new i;for(var _ in e.issuer)s=e.issuer[_].rdn,l=e.issuer[_].value,E[s]=l;var f=new Date;return{Name:u.commonName||u.CN,Issuer:E,IssuerName:E.commonName||E.CN,Subject:u,SubjectName:u.toString(),Version:n,SerialNumber:c,Thumbprint:r.replace(/\:/g,""),ValidFromDate:new Date(e.validNotBefore),ValidToDate:new Date(e.validNotAfter),HasPrivateKey:o,IsValid:f>=new Date(e.validNotBefore)&&f<=new Date(e.validNotAfter),toString:function(){return"Название:              "+this.Name+"\nИздатель:              "+this.IssuerName+"\nСубъект:               "+this.SubjectName+"\nВерсия:                "+this.Version+"\nСерийный №:            "+this.SerialNumber+"\nОтпечаток SHA1:        "+this.Thumbprint+"\nНе действителен до:    "+this.ValidFromDate+"\nНе действителен после: "+this.ValidToDate+"\nПриватный ключ:        "+(this.HasPrivateKey?"Есть":"Нет")+"\nВалидный:              "+(this.IsValid?"Да":"Нет")}}}).then(null,function(e){var t=n(e);throw new Error(t)})},this.listCertificates=function(){var i=[],o=[];return e.enumerateCertificates(t,e.CERT_CATEGORY_USER).then(function(n){i=n;var r=[];for(var o in i)r.push(e.parseCertificate(t,i[o]));return Promise.all(r)}).then(function(e){for(var t in i)o.push({id:i[t],name:r(e[t])});return o}).then(null,function(e){var t=n(e);throw new Error(t)})},this.readCertificate=function(r){return e.getCertificate(t,r).then(function(e){return o(e)}).then(null,function(e){var t=n(e);throw new Error(t)})},this.signData=function(r,i){return e.sign(t,i,r,e.DATA_FORMAT_BASE64,{detached:!0}).then(null,function(e){var t=n(e);throw new Error(t)})},this.addSign=function(r,i,o){var a=i;return e.sign(t,o,r,e.DATA_FORMAT_BASE64,{detached:!0,CMS:a}).then(null,function(e){var t=n(e);throw new Error(t)})},this.verifySign=function(r,i){var o=r;return e.verify(t,i,{data:o,base64:!0,verifyCertificate:!1}).then(function(e){if(!e)throw new Error("подпись не верна");return!0}).then(null,function(e){var t=n(e);throw new Error(t)})}};n.d(t,"DN",function(){return i}),n.d(t,"JaCarta",function(){return c}),n.d(t,"JaCarta2",function(){return _}),n.d(t,"CryptoPro",function(){return g}),n.d(t,"RuToken",function(){return S})}])});
//# sourceMappingURL=ruscrypto.min.js.map